coord_flip()+
#theme_ipsum() +
theme(legend.position = c(.8,.8),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
ggtitle(year) +
ylab("Frequency") +
xlab("Clusters") +
theme(axis.title  = element_text(size = 20), axis.text.y = element_text(size = 12), axis.text.x = element_text(size = 20), plot.title = element_text(size = 25,hjust = 0.5))  +
ylim(0, max(max(lollipop_data_1$model_1)))
grid.arrange(lollipop_plot_1 + scale_y_continuous(limits = c(NA,0.2))  + scale_x_continuous(breaks = 1:length(data1), labels = 1:length(data1), sec.axis = dup_axis(name = "Serotypes", labels = SeroLabel))+ theme(plot.margin = unit(c(.5,0.5,1,0.5), "cm")), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
}
source("CreateLollipopPlot.R")
lollipop_cluster_freqs_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Model", model1 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_VTandNVT_labelSero(year = "2007", plot_title = "PopPUNK and ggCaller", data1 = PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3), model_name_1 ="Model", model1 = simMeanggCPP3_log/sum(simMeanggCPP3_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Step Function", model1 = simMeanggCPP2/sum(simMeanggCPP2), model_name_2 ="Logistic Function", model2 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Standard Model", model1 = simMeanggCPP2/sum(simMeanggCPP2), model_name_2 ="Serotype Sub-compartments", model2 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Standard Model", model1 = simMeanggCPP2/sum(simMeanggCPP2), model_name_2 ="Serotype Sub-comp.", model2 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Standard Model", model1 = simMeanggCPP2/sum(simMeanggCPP2), model_name_2 ="Sero Sub-comp.", model2 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2004", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_2/sum(PP_mass_cluster_freq_2), model_name_1 ="Standard Model", model1 = simMeanggCPP2/sum(simMeanggCPP2), model_name_2 ="Sero Sub-comp.", model2 = simMeanggCPP2_log/sum(simMeanggCPP2_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
lollipop_cluster_freqs_2x2_VTandNVT_labelSero(year = "2007", plot_title = "PopPUNK and ggCaller", data_name = "Data", data1 = PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3), model_name_1 ="Standard Model", model1 = simMeanggCPP3/sum(simMeanggCPP3), model_name_2 ="Sero Sub-comp.", model2 = simMeanggCPP3_log/sum(simMeanggCPP3_log), PP_mass_VT, SeroLabel = PP_serotype_comp)
simMeanggCPP3
sum(simMeanggCPP3)
sum(simMeanggCPP3_log)
rbinom(1, 100, c(0,0.2,0.2,0.2))
rbinom(4, 100, c(0,0.2,0.2,0.2))
rbinom(4, 100, matrix(c(0,0.2,0.2,0.2), nrow = 2))
PP_avg_cluster_freq
sum(PP_avg_cluster_freq)
PPsero_startpop2
PPxSero_matrix_prob2
SeroVT
PPxSero_params <- list(dt = 1/36, species_no = PP_mass_clusters, sero_no = length(unique(PopPUNK_clusters$Serotype)), gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = PPsero_startpop2, Pop_eq = as.double(rowSums(PPsero_startpop2)), capacity = sum(PPsero_startpop2), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = log(0.14), prop_f = 0.38, delta = ggC_delta_ranking, m = log(0.011), migVec = PPxSero_matrix_prob, vaccTypes = SeroVT, v = 0.15, vacc_time = 0)
# ggCPP fit (logistic function model)
fitPPxSero_params <- list(dt = 1/36, species_no = PP_mass_clusters, sero_no = length(unique(PopPUNK_clusters$Serotype)), gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = PPsero_startpop2, Pop_eq = as.double(rowSums(PPsero_startpop2)), capacity = sum(PPsero_startpop2), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = -1.6952228, prop_f = 0.3875749, delta = ggC_delta_ranking, m = -3.5522149, migVec = PPxSero_matrix_prob, vaccTypes = SeroVT, v = 0.2403443, vacc_time = 0)
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP2_log <- rowMeans(WFmodel_ppxSero$run(36)[2:(PP_mass_clusters+1),])
simMeanggCPP3_log <- rowMeans(WFmodel_ppxSero$run(72)[2:(PP_mass_clusters+1),])
simMeanggCPP3_log
WFmodel_ppxSero$run(72)[,1]
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WFmodel_ppxSero$run(1)[,1]
WFmodel_ppxSero$run(72)[,1]
serotypes_mass
# create stacked barplot to investigate within cluster changes:
PP_cl <- rep((1:PP_mass_clusters),length(serotypes_mass))
PP_cl
sort(PP_cl)
# create stacked barplot to investigate within cluster changes:
PP_cl <- sort(rep((1:PP_mass_clusters),length(serotypes_mass)))
Sero <- rep((1:length(serotypes_mass)), PP_mass_clusters)
time1 <- WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1]
# create stacked barplot to investigate within cluster changes:
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
time1 <- WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1]
time1
length(time1)
length(PP_cl)
time2 <- WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1]
time3 <- WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1]
barplot_PPxSero_data <- data.frame(PP_cl,Sero,time1, time2, time3)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=value, x=time1)) +
geom_bar(position="stack", stat="identity")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE)
library("viridis")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time3, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle(year) + ylab("Frequency") + xlab("Clusters") +
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") +
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") +
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+ scale_x_continuous(position = "right") +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+ scale_y_continuous(position = "right") +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) + scale_x_continuous(position = "top") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) + scale_x_continuous(position = "top") + scale_y_discrete(limits=rev)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) + scale_x_continuous(position = "top") + scale_y_continuous(limits=rev)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) + scale_x_continuous(position = "top") + scale_y_continuous(limits=rev)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) + scale_x_continuous(position = "top")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters")
View(PP_manSeq_clusters_df)
View(PP_mass_clusters)
View(PopPUNK_clusters)
PopPUNK_clusters[which(PopPUNK_clusters$SeqYear=="2001"),]
PP_mass_cluster_freq_3
PopPUNK_clusters[which(PopPUNK_clusters$SeqYear=="2001"),]
PP_data <- rep(0, (length(serotypes_mass) * PP_mass_clusters))
PP_data_2007 <- rep(0, (length(serotypes_mass) * PP_mass_clusters))
which(PopPUNK_clusters$SeqYear=="2007")
PopPUNK_clusters$Cluster[which(PopPUNK_clusters$SeqYear=="2007")[1]]
SerotypeToIndex_dict
PP_data_2007 <- rep(0, (length(serotypes_mass) * PP_mass_clusters))
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict(PopPUNK_clusters$Serotype[i])] <-
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict(PopPUNK_clusters$Serotype[i])] + 1
}
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] <-
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] + 1
}
]
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] <-
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] + 1
}
PP_data_2007
barplot_PPxSero_data$PPdata_2007 <- PP_data_2007
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters")
PopPUNK_clusters$Cluster[which(PopPUNK_clusters$SeqYear=="2007")]
# create stacked barplot to investigate within cluster changes:
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WFmodel_ppxSero$run(1)[-(1),1]
sum(WFmodel_ppxSero$run(1)[(PP_mass_clusters+2:(2*PP_mass_clusters)),1])
PP_cl <-rep((1:PP_mass_clusters),length(serotypes_mass))
Sero <-  sort(rep((1:length(serotypes_mass)), PP_mass_clusters))
time1 <- WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1]
time2 <- WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1]
time3 <- WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1]
barplot_PPxSero_data <- data.frame(PP_cl,Sero,time1, time2, time3)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters")
sum(WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1])
# create stacked barplot to investigate within cluster changes:
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
PP_cl <-rep((1:PP_mass_clusters),length(serotypes_mass))
Sero <-  sort(rep((1:length(serotypes_mass)), PP_mass_clusters))
time1 <- WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1])
time2 <- WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1])
time3 <- WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1])
barplot_PPxSero_data <- data.frame(PP_cl,Sero,time1, time2, time3)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters")
PP_data_2007 <- rep(0, (length(serotypes_mass) * PP_mass_clusters))
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] <-
PP_data_2007[((PopPUNK_clusters$Cluster[i] -1) * length(serotypes_mass)) + SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]]] + 1
}
barplot_PPxSero_data$PPdata_2007 <- PP_data_2007
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters")
PP_data_2007 <- rep(0, (length(serotypes_mass) * PP_mass_clusters))
for (i in which(PopPUNK_clusters$SeqYear=="2007")) {
PP_data_2007[((SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]] -1) * PP_mass_clusters) + PopPUNK_clusters$Cluster[i]] <-
PP_data_2007[((SerotypeToIndex_dict[PopPUNK_clusters$Serotype[i]] -1) * PP_mass_clusters) + PopPUNK_clusters$Cluster[i]] + 1
}
barplot_PPxSero_data$PPdata_2007 <- PP_data_2007
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters")
time1
barplot_PPxSero_data$Sero
View(barplot_PPxSero_data)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity", aes(fill = Sero)) + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity", aes(fill = Sero)) + scale_fill_viridis(option = "D", discrete = TRUE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE)
ggplot(barplot_PPxSero_data, aes(fill=Sero, y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = FALSE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE)
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE)
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
IndexToSerotype_dict <- sort(unique(PopPUNK_clusters$Serotype))
names(IndexToSerotype_dict) <- 1:length(unique(PopPUNK_clusters$Serotype))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE) +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.8),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE) +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters")
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.8))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.4,.8))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.4))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
grid.arrange(sec.axis = dup_axis(name = "Serotypes", labels = SeroLabel))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
grid.arrange(sec.axis = dup_axis(name = "Serotypes", labels = IndexToSerotype_dict[as.factor(Sero)]))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
grid.arrange(sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
barplot1 <- ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
grid.arrange(barplot1, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
grid.arrange(barplot1, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
barplot1 <- ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
grid.arrange(barplot1, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
barplot1
grid.arrange(barplot1, scale_x_continuous(breaks = 1:length(data1), labels = 1:length(data1), sec.axis = dup_axis(name = "Serotypes"), labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1, scale_x_continuous(breaks = 1:62, labels = 1:62, sec.axis = dup_axis(name = "Serotypes"), labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1, scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes"), labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1, scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes")), labels = PP_serotype_comp), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1, scale_x_continuous(breaks = 1:62, sec.axis = dup_axis((name = "Serotypes"), labels = PP_serotype_comp)), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1, scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
grid.arrange(barplot1 + scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)), ncol = 1, nrow=1, top = textGrob(plot_title,gp=gpar(fontsize=20,font=3)))
barplot1 + scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))+
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters")  +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time1, x=PP_cl)) + coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2001") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time2, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2004") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=time3, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))+
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))+
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
library(ggplot2)
library("viridis")
# create stacked barplot to investigate within cluster changes:
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WF_PPxSero <- odin.dust::odin_dust("NFDS_Model_PPxSero.R")
# create stacked barplot to investigate within cluster changes:
WFmodel_ppxSero <- WF_PPxSero$new(pars = fitPPxSero_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
PP_cl <-rep((1:PP_mass_clusters),length(serotypes_mass))
Sero <-  sort(rep((1:length(serotypes_mass)), PP_mass_clusters))
time1 <- WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(1)[-(1:(PP_mass_clusters+1)),1])
time2 <- WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(36)[-(1:(PP_mass_clusters+1)),1])
time3 <- WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1]/sum(WFmodel_ppxSero$run(72)[-(1:(PP_mass_clusters+1)),1])
barplot_PPxSero_data <- data.frame(PP_cl,Sero,time1, time2, time3)
ggplot(barplot_PPxSero_data, aes(fill=as.factor(Sero), y=time1, x=PP_cl)) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))
PP_data_2007
sum(PP_data_2007)
PP_data_2007 <- PP_data_2007/ sum(PP_data_2007)
barplot_PPxSero_data$PPdata_2007 <- PP_data_2007
ggplot(barplot_PPxSero_data, aes(fill=IndexToSerotype_dict[as.factor(Sero)], y=PPdata_2007, x=PP_cl)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007 DATA") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20))+
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp))
barplot_PPxSero_data2 <- data.frame(rep(PP_cl,2), rep(Sero,2),c(time1, PP_data_2007))
View(barplot_PPxSero_data2)
barplot_PPxSero_data2 <- data.frame(rep(PP_cl,2), rep(Sero,2),c(time3, PP_data_2007))
barplot_PPxSero_data2$category <- c(rep("model",length(PP_cl)),rep("data",length(PP_cl)))
colnames(barplot_PPxSero_data2) <- c("Cluster","Serotype","Value","category")
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=category)) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=as.factor(category))) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)) +
facet_grid( ~ Cluster)
barplot_PPxSero_data2$category <- c(rep(0,length(PP_cl)),rep(1,length(PP_cl)))
colnames(barplot_PPxSero_data2) <- c("Cluster","Serotype","Value","category")
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=as.factor(category))) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +  coord_flip()+
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62, sec.axis = dup_axis(name = "Serotypes", labels = PP_serotype_comp)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(labels = (c("M","D"))) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:62) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:(2*62)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:(2*62), labels = rep(c("M","D"),62)) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:2, labels = (c("M","D"))) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_continuous(breaks = 1:2) +
facet_grid( ~ Cluster)
barplot_PPxSero_data2$category <- c(rep("M",length(PP_cl)),rep("D",length(PP_cl)))
colnames(barplot_PPxSero_data2) <- c("Cluster","Serotype","Value","category")
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_discrete(breaks = 1:2) +
facet_grid( ~ Cluster)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
scale_x_discrete(breaks = 1:2, labels = c("M","D")) +
facet_grid( ~ Cluster)
barplot_PPxSero_data2$category <- c(rep(0,length(PP_cl)),rep(1,length(PP_cl)))
colnames(barplot_PPxSero_data2) <- c("Cluster","Serotype","Value","category")
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous("Model / Data", labels = c("M","D"), breaks = ID)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous("Model / Data", labels = c("M","D"), breaks = category)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) + scale_x_continuous("Model / Data", labels = c("M","D"), breaks = category)
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) + scale_x_continuous("Model / Data", labels = c("M","D"), breaks = barplot_PPxSero_data2$category)
barplot_PPxSero_data2$category
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) + scale_x_continuous("Model / Data", labels = c("M","D"), breaks = c(0,1))
ggplot(barplot_PPxSero_data2, aes(fill=IndexToSerotype_dict[as.factor(Serotype)], y=Value, x=(category))) +
geom_bar(position="stack", stat="identity") + scale_fill_viridis(option = "D", discrete = TRUE, name = "Serotype") +
ggtitle("2007") + ylab("Frequency") + xlab("Clusters") + theme(legend.position = c(.8,.6),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
facet_grid( ~ Cluster) + scale_x_continuous("Model / Data", labels = c("M","D"), breaks = c(0,1))
