### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1180783495, sigma_w = 0.0004164005, prop_f = 0.3803173188, delta = ggC_delta_ranking, m = 0.0117180887, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.1509501052, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
ggCPP_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP[i]
}
sum(abs(PP_mass_cluster_freq_3_asManSeqCl/sum(PP_mass_cluster_freq_3_asManSeqCl) - ggCPP_fit_asManSeqCl/sum(ggCPP_fit_asManSeqCl)))
combined_compare(ggCPP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
combined_compare(ggCPP_fit_asManSeqCl/sum(ggCPP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl/sum(PP_mass_cluster_freq_3_asManSeqCl))
)
combined_compare(ggCPP_fit_asManSeqCl/sum(ggCPP_fit_asManSeqCl),PP_mass_cluster_freq_3_asManSeqCl/sum(PP_mass_cluster_freq_3_asManSeqCl))
combined_compare(ggCPP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
combined_compare(PP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
# COG man seq clusters
params_n_vP <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1789665082, sigma_w = 0.0006039627, prop_f = 0.3669067334 , delta = delta_ranking, m = 0.0078524723 , migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.1103623064, vacc_time = 0)
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
combined_compare(simMean,mass_cluster_freq_3)
### ggCaller man seq clusters
params_ggC <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(ggC_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = ggC_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1882242231, sigma_w = 0.0003669121, prop_f = 0.2161135322, delta = ggC_delta_ranking, m = 0.0059668667, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.1377344552, vacc_time = 0)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
combined_compare(simMeanggC,mass_cluster_freq_3)
plot((PP_manSeq_clusters_df$manSeqCl),PP_manSeq_clusters_df$PP)
# create dict from man seq clusters to PopPUNK
manSeq_to_PP_dict <- rep(0,mass_clusters)
for (i in 1:mass_clusters) {
manSeq_to_PP_dict[i] <- manSeq_to_PP_dict$manSeqCl[which(PP_manSeq_clusters_df$manSeqCl==i)]
}
# create dict from man seq clusters to PopPUNK
manSeq_to_PP_dict <- rep(0,mass_clusters)
for (i in 1:mass_clusters) {
manSeq_to_PP_dict[i] <- PP_manSeq_clusters_df$manSeqCl[which(PP_manSeq_clusters_df$manSeqCl==i)]
}
for (i in 1:mass_clusters) {
manSeq_to_PP_dict[i] <- PP_manSeq_clusters_df$PP[which(PP_manSeq_clusters_df$manSeqCl==i)]
}
# create dict from man seq clusters to PopPUNK
manSeq_to_PP_dict <- rep(0,mass_clusters)
for (i in 1:mass_clusters) {
manSeq_to_PP_dict[i] <- PP_manSeq_clusters_df$PP[which(PP_manSeq_clusters_df$manSeqCl==i-1)]
}
names(manSeq_to_PP_dict) <- 1:mass_clusters
warnings()
names(manSeq_to_PP_dict) <- 1:mass_clusters
manSeq_to_PP_dict
for (i in 1:mass_clusters) {
print(PP_manSeq_clusters_df$PP[which(PP_manSeq_clusters_df$manSeqCl==i-1)])
}
plot(1:mass_clusters, PP_manSeq_clusters_df$PP[which(PP_manSeq_clusters_df$manSeqCl==i-1)])
counts <- table(mtcars$vs, mtcars$gear)
counts
mtcars$vs
# plot man seq cluster composition
PP_manSeqCl_plt_data <- table(PP_manSeq_clusters_df$manSeqCl,PP_manSeq_clusters_df$PP)
PP_manSeqCl_plt_data
barplot(PP_manSeqCl_plt_data, main="Car Distribution",
xlab="Number of Gears")
# plot man seq cluster composition
PP_manSeqCl_plt_data <- table(PP_manSeq_clusters_df$PP,PP_manSeq_clusters_df$manSeqCl)
barplot(PP_manSeqCl_plt_data, main="Car Distribution",
xlab="Number of Gears")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in Manual Sequence Clusters",
xlab="Manual Sequence CLusters")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution\\ in Manual Sequence Clusters",
xlab="Manual Sequence CLusters")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters",legend = rownames(PP_manSeqCl_plt_data))
library("colorspace")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis)
library("viridis")
install.packages("viridis")
#ggplot(PP_manSeq_clusters_df, aes(fill=condition, y=value, x=specie)) +
#    geom_bar(position="stack", stat="identity")
#library("colorspace")
#install.packages("viridis")
library("viridis")
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(62))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),fill=guide_legend(ncol=2))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(ncol=2))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(ncol=4))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 100, y = 10, ncol=4))
barplot(height = 100, PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 100, y = 10, ncol=4))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 100, y = 10, ncol=4),ylim = 100)
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 100, y = 10, ncol=4),ylim = 80)
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 100, y = 10, ncol=4),ylim = c(0,100))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 20, y = 100, ncol=4),ylim = c(0,100))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 40, y = 100, ncol=4),ylim = c(0,100))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 50, y = 100, ncol=4),ylim = c(0,100))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 55, y = 100, ncol=4),ylim = c(0,100))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 55, y = 100, ncol=4),ylim = c(0,100), xlim = c(0,50))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 55, y = 100, ncol=4),ylim = c(0,100), xlim = c(0,55))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 60, y = 100, ncol=4),ylim = c(0,100), xlim = c(0,55))
barplot(PP_manSeqCl_plt_data, main="PopPUNK cluster distribution in manSeqCl",
xlab="Manual Sequence CLusters", col = viridis(PP_mass_clusters), legend = rownames(PP_manSeqCl_plt_data),args.legend = c(x = 60, y = 100, ncol=4),ylim = c(0,100), xlim = c(0,60))
# COG man seq clusters
params_n_vP <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.007877661, sigma_w = 0.0, prop_f = 1.0 , delta = delta_ranking, m = 0.008008877, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.048982297, vacc_time = 0)
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean/sum(simMean)))
# [1] 0.407629
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean/sum(simMean)))/mass_clusters
### COG PopPUNK
all_params <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(PP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = PP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.004034883, sigma_w = 0, prop_f = 1, delta = delta_ranking, m = 0.009046951, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.044083001, vacc_time = 0)
WFmodel_PP <- WF_nG_h_vP$new(pars = all_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanPP <- rowMeans(WFmodel_PP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP/sum(simMeanPP)))
# [1] 0.4440668
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP/sum(simMeanPP)))/PP_mass_clusters
### ggCaller man seq clusters
params_ggC <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(ggC_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = ggC_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.01006930, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.01635317, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.08659896, vacc_time = 0)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC/sum(simMeanggC)))
# [1] 0.3908194
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC/sum(simMeanggC)))/mass_clusters
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.118078349, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.03104461, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.15977862, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP/sum(simMeanggCPP)))
# [1] 0.4220826
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP/sum(simMeanggCPP)))/PP_mass_clusters
p3_PP_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_PP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_PP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP[i]
}
p3_ggCPP_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP[i]
}
# COG man seq clusters
combined_compare(simMean,mass_cluster_freq_3)
# COG PopPUNK
combined_compare(p3_PP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
# ggC man seq clusters
combined_compare(simMeanggC,mass_cluster_freq_3)
# ggC PopPUNK
combined_compare(p3_ggCPP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
p3_ggCPP_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_ggCPP_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP[i]
}
# ggC PopPUNK
combined_compare(p3_ggCPP_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
WF_null <- odin.dust::odin_dust("null_NFDS_Model.R")
PP_mass_cluster_freq_2_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP_mass_cluster_freq_2_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP_mass_cluster_freq_2_asManSeqCl[PP_to_manSeq_dict[i]+1] + PP_mass_cluster_freq_2[i]
}
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP2 <- rowMeans(WFmodel_ggCPP$run(36)[-1,])
simMeanggCPP3 <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
ggCPP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP3[i]
}
# ggC PopPUNK
combined_compare(ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) +
combined_compare(ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
ggCPP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP2[i]
}
ggCPP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP3[i]
}
# ggC PopPUNK
combined_compare(ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) +
combined_compare(ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC2 <- rowMeans(WFmodel_ggCmanSeqCl$run(36)[-1,])
simMeanggC3 <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
WFmodel_PP <- WF_nG_h_vP$new(pars = all_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanPP2 <- rowMeans(WFmodel_PP$run(36)[-1,])
simMeanPP3 <- rowMeans(WFmodel_PP$run(72)[-1,])
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean2 <- rowMeans(WFmodel_nG_h_vP$run(36)[-1,])
simMean3 <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
PP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP2[i]
}
PP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP3[i]
}
# COG man seq clusters
combined_compare(simMean2,mass_cluster_freq_2) + combined_compare(simMean3,mass_cluster_freq_3)
# COG PopPUNK
combined_compare(PP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) + combined_compare(PP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
# ggC man seq clusters
combined_compare(simMeanggC2,mass_cluster_freq_2) + combined_compare(simMeanggC3,mass_cluster_freq_3)
# ggC PopPUNK
combined_compare(ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) +
combined_compare(ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1180783495, sigma_w = 0.0004164005, prop_f = 0.3803173188, delta = ggC_delta_ranking, m = 0.0117180887, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.1509501052, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP2 <- rowMeans(WFmodel_ggCPP$run(36)[-1,])
simMeanggCPP3 <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP3/sum(simMeanggCPP3)))
# [1] 0.4220826
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP3/sum(simMeanggCPP3)))/PP_mass_clusters
PP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP2[i]
}
PP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP3[i]
}
ggCPP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP2[i]
}
ggCPP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP3[i]
}
# ggC PopPUNK
combined_compare(ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) +
combined_compare(ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
# COG man seq clusters
params_n_vP <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1789665082, sigma_w = 0.0006039627, prop_f = 0.3669067334 , delta = delta_ranking, m = 0.0078524723 , migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.1103623064, vacc_time = 0)
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean2 <- rowMeans(WFmodel_nG_h_vP$run(36)[-1,])
simMean3 <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean3/sum(simMean3)))
# [1] 0.407629
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean3/sum(simMean3)))/mass_clusters
# [1] 0.009942172
### COG PopPUNK
all_params <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(PP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = PP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1764665767, sigma_w = 0.0005367709, prop_f = 0.437293239, delta = delta_ranking, m = 0.0114977275, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.1135499700, vacc_time = 0)
WFmodel_PP <- WF_nG_h_vP$new(pars = all_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanPP2 <- rowMeans(WFmodel_PP$run(36)[-1,])
simMeanPP3 <- rowMeans(WFmodel_PP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP3/sum(simMeanPP3)))
# [1] 0.4440668
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP3/sum(simMeanPP3)))/PP_mass_clusters
# [1] 0.007162368
### ggCaller man seq clusters
params_ggC <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(ggC_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = ggC_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1882242231, sigma_w = 0.0003669121, prop_f = 0.2161135322, delta = ggC_delta_ranking, m = 0.0059668667, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.1377344552, vacc_time = 0)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC2 <- rowMeans(WFmodel_ggCmanSeqCl$run(36)[-1,])
simMeanggC3 <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC3/sum(simMeanggC3)))
# [1] 0.3908194
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC3/sum(simMeanggC3)))/mass_clusters
# [1] 0.009532182
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.1180783495, sigma_w = 0.0004164005, prop_f = 0.3803173188, delta = ggC_delta_ranking, m = 0.0117180887, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.1509501052, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP2 <- rowMeans(WFmodel_ggCPP$run(36)[-1,])
simMeanggCPP3 <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP3/sum(simMeanggCPP3)))
# [1] 0.4220826
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP3/sum(simMeanggCPP3)))/PP_mass_clusters
# [1] 0.006807784
PP_mass_cluster_freq_3_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP_mass_cluster_freq_3_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP_mass_cluster_freq_3_asManSeqCl[PP_to_manSeq_dict[i]+1] + PP_mass_cluster_freq_3[i]
}
PP_mass_cluster_freq_2_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP_mass_cluster_freq_2_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP_mass_cluster_freq_2_asManSeqCl[PP_to_manSeq_dict[i]+1] + PP_mass_cluster_freq_2[i]
}
PP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP2[i]
}
PP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP3[i]
}
ggCPP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP2[i]
}
ggCPP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP3[i]
}
# COG man seq clusters
combined_compare(simMean2,mass_cluster_freq_2) + combined_compare(simMean3,mass_cluster_freq_3)
# [1] -253.8705
# COG PopPUNK
combined_compare(PP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) + combined_compare(PP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
#[1] -250.98
# ggC man seq clusters
combined_compare(simMeanggC2,mass_cluster_freq_2) + combined_compare(simMeanggC3,mass_cluster_freq_3)
#[1] -251.7233
# ggC PopPUNK
combined_compare(ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) +
combined_compare(ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
#[1] -179.3374
# COG man seq clusters
params_n_vP <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.007877661, sigma_w = 0.0, prop_f = 1.0 , delta = delta_ranking, m = 0.008008877, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.048982297, vacc_time = 0)
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean/sum(simMean)))
# [1] 0.6136608
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMean/sum(simMean)))/mass_clusters
# [1] 0.01496734
### COG PopPUNK
all_params <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(PP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = PP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.004034883, sigma_w = 0, prop_f = 1, delta = delta_ranking, m = 0.009046951, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.044083001, vacc_time = 0)
WFmodel_PP <- WF_nG_h_vP$new(pars = all_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanPP <- rowMeans(WFmodel_PP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP/sum(simMeanPP)))
# [1] 0.650785
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanPP/sum(simMeanPP)))/PP_mass_clusters
# [1] 0.01049653
### ggCaller man seq clusters
params_ggC <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(ggC_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = ggC_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.01006930, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.01635317, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.08659896, vacc_time = 0)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC/sum(simMeanggC)))
# [1] 0.5759087
sum(abs(mass_cluster_freq_3/sum(mass_cluster_freq_3) - simMeanggC/sum(simMeanggC)))/mass_clusters
# [1] 0.01404655
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.118078349, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.03104461, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.15977862, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP/sum(simMeanggCPP)))
# [1] 0.7404015
sum(abs(PP_mass_cluster_freq_3/sum(PP_mass_cluster_freq_3) - simMeanggCPP/sum(simMeanggCPP)))/PP_mass_clusters
# [1] 0.01194196
WFmodel_PP <- WF_nG_h_vP$new(pars = all_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanPP2 <- rowMeans(WFmodel_PP$run(36)[-1,])
simMeanPP3 <- rowMeans(WFmodel_PP$run(72)[-1,])
### ggCaller man seq clusters
params_ggC <- list(dt = 1/36, species_no = mass_clusters,  gene_no = nrow(ggC_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(model_start_pop), Pop_eq = as.double(model_start_pop), capacity = sum(model_start_pop), Genotypes = ggC_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.01006930, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.01635317, migVec = avg_cluster_freq, vaccTypes = mass_VT, v = 0.08659896, vacc_time = 0)
WFmodel_ggCmanSeqCl <- WF_nG_h_vP$new(pars = params_ggC,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggC2 <- rowMeans(WFmodel_ggCmanSeqCl$run(36)[-1,])
simMeanggC3 <- rowMeans(WFmodel_ggCmanSeqCl$run(72)[-1,])
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.118078349, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.03104461, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.15977862, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WFmodel_nG_h_vP <- WF_nG_h_vP$new(pars = params_n_vP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMean2 <- rowMeans(WFmodel_nG_h_vP$run(36)[-1,])
simMean3 <- rowMeans(WFmodel_nG_h_vP$run(72)[-1,])
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
### ggCaller PopPUNK
params_ggCPP <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, sigma_f = 0.118078349, sigma_w = 0, prop_f = 1, delta = ggC_delta_ranking, m = 0.03104461, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v = 0.15977862, vacc_time = 0)
WFmodel_ggCPP <- WF_nG_h_vP$new(pars = params_ggCPP,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
simMeanggCPP2 <- rowMeans(WFmodel_ggCPP$run(36)[-1,])
simMeanggCPP3 <- rowMeans(WFmodel_ggCPP$run(72)[-1,])
p3_PP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP3[i]
}
p3_ggCPP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_ggCPP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP2[i]
}
p3_ggCPP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_ggCPP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanggCPP3[i]
}
# COG man seq clusters
combined_compare(simMean2,mass_cluster_freq_2) + combined_compare(simMean3,mass_cluster_freq_3)
# COG PopPUNK
combined_compare(p3_PP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) + combined_compare(p3_PP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
p3_PP2_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_PP2_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP2[i]
}
p3_PP3_fit_asManSeqCl <- rep(0,mass_clusters)
for (i in 1:PP_mass_clusters) {
p3_PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] <- p3_PP3_fit_asManSeqCl[PP_to_manSeq_dict[i]+1] + simMeanPP3[i]
}
# COG PopPUNK
combined_compare(p3_PP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) + combined_compare(p3_PP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
# ggC man seq clusters
combined_compare(simMeanggC2,mass_cluster_freq_2) + combined_compare(simMeanggC3,mass_cluster_freq_3)
# ggC PopPUNK
combined_compare(p3_ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl) + combined_compare(p3_ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
combined_compare(p3_ggCPP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl)
combined_compare(p3_ggCPP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
combined_compare(p3_PP3_fit_asManSeqCl,PP_mass_cluster_freq_3_asManSeqCl)
combined_compare(p3_PP2_fit_asManSeqCl,PP_mass_cluster_freq_2_asManSeqCl)
