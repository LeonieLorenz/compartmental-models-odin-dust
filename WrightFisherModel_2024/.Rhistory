gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,],1,calculate_rowSum)
gene_cluster_freqs_2
equal(gene_cluster_freqs_1,gene_cluster_freqs_2)
identical(gene_cluster_freqs_1,gene_cluster_freqs_2)
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
identical(gene_cluster_freqs_1,gene_cluster_freqs_2)
gene_cluster_freqs_2
gene_cluster_freqs_2 <- rep(0, length(cls_files))
calculate_rowSum <- function(data_row){
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2
gene_presence_absence_2001[-1,-1]
gene_cluster_freqs_2 <- rep(0, length(cls_files))
calculate_rowSum <- function(data_row){
print(data_row_)
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(data_row)
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(as.numeric(data_row==1))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(sum(as.numeric(data_row==1)))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2
dim(apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum))
calculate_rowSum <- function(data_row){
#print(sum(as.numeric(data_row==1)))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2[1]
apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)[1]
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
gene_cluster_freqs_2 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
gene_cluster_freqs_1
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
gene_cluster_freqs_1
gene_cluster_freqs_2
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_2
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
gene_cluster_freqs_3
length(gene_presence_absence_2001[1,-1])
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))/length(gene_presence_absence_2001[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))/length(gene_presence_absence_2004[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))/length(gene_presence_absence_2004[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
```
length(gene_presence_absence_2007[1,-1])
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))/length(gene_presence_absence_2007[1,-1])
}
gene_cluster_freqs_2
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_2)
sort.list(gene_cluster_freqs_1)
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_1)
gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)]
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)])
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)])
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
line(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "l", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "l", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9")
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
library(zoo)
rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 3)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 3))
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 20))
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 20), col = "#E69F00", lty = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00")
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", pch = 19)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 100), col = "#E69F00", pch = 19)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 100), col = "#E69F00", lwd = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#E69F00", lwd = 5)
path_to_data <- "~/Documents/PhD_Project/Data/"
### Reading in the Accession Codes, Population and the Sequence Clusters
library(readxl)
Samples_accCodes <- read_excel(paste(path_to_data, "Massachusetts_data_NickCroucher/SupplementaryDataPaper/Samples_accCodes.xlsx", sep = ""))
Mass_Samples_accCodes <- Samples_accCodes[Samples_accCodes$Population=="Massachusetts",]
Mass_Isolates <- Mass_Samples_accCodes$`Isolate Name`
Mass_Isolates_dict <- 1:length(Mass_Isolates)
names(Mass_Isolates_dict) <- Mass_Isolates
Isolates <- Samples_accCodes$`Isolate Name`
Isolates_dict <- 1:length(Isolates)
names(Isolates_dict) <- Isolates
Isolate_from_Mass_dict <- rep(0, length(Isolates))
names(Isolate_from_Mass_dict) <- Isolates
Isolate_from_Mass_dict[Mass_Isolates] <- 1
### Reading in the Gene Cluster information
#gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ]
#function for reading cluster files
read_cls_file <- function(path_to_file){
read.table(path_to_file, quote="\"", comment.char="")[ c(TRUE,FALSE), ]
}
#function for splitting the COG from the gene start
split_isolate_name <- function(text_line){
name_vec <- strsplit(strsplit(text_line,">")[[1]][2],"_")
paste(head(name_vec[[1]],-1), collapse = "_")
}
#isolates_gene_cluster <- unlist(lapply(gene_cluster, split_isolate_name))
# filter for Mass only
#Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
# returns the Massachusetts-specific index of any Mass COG
return_isolate_index <- function(name){
Mass_Isolates_dict[[name]]
}
#indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
# list of input files
cls_files <- list.files(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences", sep = ""), full.names = TRUE, recursive = FALSE)
# empty gene presence absence matrix
gene_presence_absence <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Isolates)+1))
gene_presence_absence[1,-1] <- Mass_Isolates
# reads in all input files (takes a while, around 2000 files)
isolates_in_clusters <- (lapply(cls_files, read_cls_file))
# splits isolate names, changes values in gene presence absence matrix to 1 when genes are found
for (i in 1:length(isolates_in_clusters)) {
isolates_gene_cluster <- unlist(lapply(isolates_in_clusters[[i]], split_isolate_name))
Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
help_vector <- rep(0, length(Mass_Isolates))
help_vector[indices_gene_clusters] <- 1
gene_presence_absence[i+1,] <- c(strsplit(tail(strsplit(cls_files[i],"/")[[1]],1),"\\.")[[1]][1], help_vector)
}
saveRDS(gene_presence_absence, file = "gene_presence_absence.rds")
head(isolates_in_clusters)
gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ]
gene_cluster
gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")
gene_cluster
gene_cluster[1]
data.frame(c(read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ], read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(FALSE,TRUE), ]))
test_df <- data.frame(c(read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ], read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(FALSE,TRUE), ]))
View(test_df)
test_df <- data.frame(matrix(data = c(read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ], read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(FALSE,TRUE), ]), ncol = 2)
)
View(test_df)
test_vec <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")
head(test_vec)
test_vec <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[,]
head(test_vec)
cls_lines <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[,]
seq(1,length(cls_lines),by=2)
cls_names_seqs <- data.frame(matrix(data = c(cls_names, cls_seqs), ncol = 2))
cls_names <- cls_lines[seq(1,length(cls_lines),by=2)]
cls_seqs <- cls_lines[seq(2,length(cls_lines),by=2)]
cls_names_seqs <- data.frame(matrix(data = c(cls_names, cls_seqs), ncol = 2))
View(cls_names_seqs)
#function for splitting the COG from the gene start
split_isolate_name <- function(text_line){
name_vec <- strsplit(strsplit(text_line,">")[[1]][2],"_")
paste(head(name_vec[[1]],-1), collapse = "_")
}
cls_names2 <- (lapply(cls_names, split_isolate_name))
head(cls_names2)
cls_names2 <- unlist(lapply(cls_names, split_isolate_name))
head(cls_names2)
cls_names2[2]
cls_lines <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[,]
cls_lines <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[,]
cls_names <- unlist(lapply(cls_lines[seq(1,length(cls_lines),by=2)], split_isolate_name))
cls_seqs <- cls_lines[seq(2,length(cls_lines),by=2)]
cls_names_seqs <- data.frame(matrix(data = c(cls_names, cls_seqs), ncol = 2))
cls_names[Isolate_from_Mass_dict[cls_names]==1]
cls_names_Mass <- cls_names[Isolate_from_Mass_dict[cls_names]==1]
length(cls_names_Mass)
length(cls_names)
cls_seqs_Mass <- cls_seqs[Isolate_from_Mass_dict[cls_names]==1]
cls_names_seqs <- data.frame(matrix(data = c(cls_names_Mass, cls_seqs_Mass), ncol = 2))
### Reading in the Accession Codes, Population and the Sequence Clusters
library(readxl)
Samples_accCodes <- read_excel(paste(path_to_data, "Massachusetts_data_NickCroucher/SupplementaryDataPaper/Samples_accCodes.xlsx", sep = ""))
Mass_Samples_accCodes <- Samples_accCodes[Samples_accCodes$Population=="Massachusetts",]
Isolates <- Samples_accCodes$`Isolate Name`
Isolates_dict <- 1:length(Isolates)
names(Isolates_dict) <- Isolates
Isolate_from_Mass_dict <- rep(0, length(Isolates))
names(Isolate_from_Mass_dict) <- Isolates
Isolate_from_Mass_dict[Mass_Isolates] <- 1
#function for reading cluster files
read_cls_file_all <- function(path_to_file){
read.table(path_to_file, quote="\"", comment.char="")[,]
}
# reads in all input files (takes a while, around 2000 files)
cls_lines <- (lapply(cls_files, read_cls_file_all))
# reads in all input files (takes a while, around 2000 files)
cls_lines <- unlist(lapply(cls_files, read_cls_file_all))
head(cls_lines)
cls_names <- unlist(lapply(cls_lines[seq(1,length(cls_lines),by=2)], split_isolate_name))
cls_names <- unlist(lapply(cls_lines[seq(1,length(cls_lines),by=2)], split_isolate_name))
cls_seqs <- cls_lines[seq(2,length(cls_lines),by=2)]
cls_names_Mass <- cls_names[Isolate_from_Mass_dict[cls_names]==1]
cls_seqs_Mass <- cls_seqs[Isolate_from_Mass_dict[cls_names]==1]
cls_names_seqs <- data.frame(matrix(data = c(cls_names_Mass, cls_seqs_Mass), ncol = 2))
cls_fasta_headers <- cls_lines[seq(1,length(cls_lines),by=2)]
cls_fasta_headers_Mass <- cls_fasta_headers[Isolate_from_Mass_dict[cls_names]==1]
cls_names_seqs <- data.frame(matrix(data = c(cls_names_Mass, cls_seqs_Mass, cls_fasta_headers_Mass), ncol = 3))
write(cls_names_seqs[,c(2,3)], "COGtriangles_allMassClusters.fasta", sep = "\n")
cls_names_seqs[1,c(2,3)]
cls_names_seqs <- data.frame(matrix(data = c(cls_names_Mass, cls_fasta_headers_Mass, cls_seqs_Mass), ncol = 3))
View(cls_names_seqs)
write.csv(cls_names_seqs[1:10,c(2,3)], row.names = FALSE)
write.csv(cls_names_seqs[1:10,c(2,3)], "COGtriangles_allMassClusters.fasta", row.names = FALSE)
write.csv(cls_names_seqs[1:10,c(2,3)], "COGtriangles_allMassClusters.fasta", row.names = FALSE, col.names = FALSE)
write.table(cls_names_seqs[1:10,c(2,3)], "COGtriangles_allMassClusters.fasta", row.names = FALSE, col.names = FALSE, sep = "\n")
write.table(cls_names_seqs[1:10,c(2,3)], "COGtriangles_allMassClusters.fasta", row.names = FALSE, col.names = FALSE, sep = "\n", quote = FALSE)
write.table(cls_names_seqs[,c(2,3)], "COGtriangles_allMassClusters.fasta", row.names = FALSE, col.names = FALSE, sep = "\n", quote = FALSE)
write.table(cls_names_seqs[,c(2,3)], paste(path_to_data, "v2_Massachusetts_data_NickCroucher/COGtriangles_allMassClusters.fasta"), row.names = FALSE, col.names = FALSE, sep = "\n", quote = FALSE)
write.table(cls_names_seqs[,c(2,3)], paste(path_to_data, "v2_Massachusetts_data_NickCroucher/COGtriangles_allMassClusters.fasta", sep = ""), row.names = FALSE, col.names = FALSE, sep = "\n", quote = FALSE)
# create time-point specific gene presence absence matrices
Mass_year_dict <- c(rep(2001,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)),
rep(2004,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)),
rep(2007,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)))
names(Mass_year_dict) <- c(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
# empty gene presence absence matrix
gene_presence_absence_2001 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
gene_presence_absence_2001[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2001[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001)]
gene_presence_absence_2004 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
gene_presence_absence_2004[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
gene_presence_absence_2004[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2004[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004)]
gene_presence_absence_2007 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
gene_presence_absence_2007[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
gene_presence_absence_2007[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2007[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2007)]
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))/length(gene_presence_absence_2001[1,-1])
}
#gene_cluster_freqs_1 <- rep(0, length(cls_files))
#calculate_rowSum <- function(data_row){
#print(sum(as.numeric(data_row==1)))
#  sum(as.numeric(data_row==1))
#}
#gene_cluster_freqs_1 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))/length(gene_presence_absence_2004[1,-1])
}
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))/length(gene_presence_absence_2007[1,-1])
}
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
#plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
legend(1, 95, legend=c("2001", "2004", "2007"),
col=c("black", "#E69F00","#56B4E9"), lty=1:2, cex=0.8)
#plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
legend(1, 95, legend=c("2001", "2004", "2007"),col=c("black", "#E69F00","#56B4E9"), lty=1:2, cex=0.8)
legend(1, 0.8, legend=c("2001", "2004", "2007"),col=c("black", "#E69F00","#56B4E9"), lty=1:2, cex=0.8)
legend(1, 1, legend=c("2001", "2004", "2007"),col=c("black", "#E69F00","#56B4E9"), lty=1:2, cex=0.8)
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
legend(1, 1, legend=c("2001", "2004", "2007"),col=c("black", "#E69F00","#56B4E9"), lty=1:2, cex=0.8)
#plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
legend(1, 1, legend=c("2001", "2004", "2007"),col=c("black", "#E69F00","#56B4E9"), lty=1, cex=1)
#plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
# Plotting the changes in gene cluster frequencies between the 1st time point and the 2nd and 3rd, respectively, including a rolling mean
# I thought maybe there would be a correlation between the gene frequency and it variability. Well, there isn't.
library(zoo)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
legend(1, 0.15, legend=c("2001 - 2004", "Rollmean"),col=c("black", "#E69F00"), lty=1, cex=1)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
legend(1, 0.15, legend=c("2001 minus 2004", "Rollmean"),col=c("black", "#E69F00"), lty=1, cex=1)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#56B4E9", lwd = 5)
legend(1, 0.15, legend=c("2001 minus 2007", "Rollmean"),col=c("black", "#56B4E9"), lty=1, cex=1)
R --version
version
# read in gene presence absence matrix
gene_presence_absence <- readRDS(file = "gene_presence_absence.rds")
# create time-point specific gene presence absence matrices
Mass_year_dict <- c(rep(2001,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)),
rep(2004,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)),
rep(2007,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)))
names(Mass_year_dict) <- c(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
# empty gene presence absence matrix
gene_presence_absence_2001 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
gene_presence_absence_2001[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2001[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001)]
gene_presence_absence_2004 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
gene_presence_absence_2004[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
gene_presence_absence_2004[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2004[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004)]
gene_presence_absence_2007 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
gene_presence_absence_2007[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
gene_presence_absence_2007[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2007[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2007)]
# Find intermediate frequency genes in 2001 data set
# compute gene frequencies
sum_as_int <- function(x){
sum(as.integer(x))
}
gene_freq_2001 <- rep(0, nrow(gene_presence_absence_2001)-1)
gene_freq_2001 <- apply(gene_presence_absence_2001[-1,-1],1, sum_as_int)
gene_freq_2001 <- gene_freq_2001 / (length(gene_presence_absence_2001[1,-1]))
cog_filter <- as.integer(gene_freq_2001<=0.95 & gene_freq_2001>=0.05)
# intermediate gene presence absence matrices filtered by genes that are present at 5-95% frequency in 2001
intermed_gene_presence_absence_2001 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
intermed_gene_presence_absence_2001 <- gene_presence_absence_2001[c(1,which(cog_filter==1)+1),]
intermed_gene_presence_absence_2004 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
intermed_gene_presence_absence_2004 <- gene_presence_absence_2004[c(1,which(cog_filter==1)+1),]
intermed_gene_presence_absence_2007 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
intermed_gene_presence_absence_2007 <- gene_presence_absence_2007[c(1,which(cog_filter==1)+1),]
intermed_gene_presence_absence <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(Mass_Samples_accCodes$`Isolate Name`)+1))
intermed_gene_presence_absence <- gene_presence_absence[c(1,which(cog_filter==1)+1),]
#Compute consensus genomes for sequence clusters
Mass_seq_clusters_dict <- Mass_Samples_accCodes$SequenceCluster
names(Mass_seq_clusters_dict) <- Mass_Samples_accCodes$`Isolate Name`
intermed_gene_presence_absence_consensus <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2001 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2001[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2004 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2004[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2007 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2007[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
cons_genomes <- function(x){
as.double(median(as.integer(x)))
}
for (i in unique(Mass_Samples_accCodes$SequenceCluster)) {
intermed_gene_presence_absence_consensus[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2001[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2001[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2001[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2004[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2004[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2004[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2007[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2007[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2007[1,-1])]==i)]), 1, cons_genomes)
}
intermed_gene_presence_absence_consensus[-1,1] <- intermed_gene_presence_absence[-1,1]
View(intermed_gene_presence_absence_consensus_2001)
intermed_gene_presence_absence_consensus_2001[-1,1] <- intermed_gene_presence_absence[-1,1]
intermed_gene_presence_absence_consensus_2004[-1,1] <- intermed_gene_presence_absence[-1,1]
intermed_gene_presence_absence_consensus_2007[-1,1] <- intermed_gene_presence_absence[-1,1]
#save intermed gene presence absence matrices
saveRDS(intermed_gene_presence_absence_consensus, file = "intermed_gene_presence_absence_consensus.rds")
saveRDS(intermed_gene_presence_absence_consensus_2001, file = "intermed_gene_presence_absence_consensus_2001.rds")
saveRDS(intermed_gene_presence_absence_consensus_2004, file = "intermed_gene_presence_absence_consensus_2004.rds")
saveRDS(intermed_gene_presence_absence_consensus_2007, file = "intermed_gene_presence_absence_consensus_2007.rds")
# read in gene presence absence matrix
intermed_gene_presence_absence_consensus <- readRDS(file = "intermed_gene_presence_absence_consensus.rds")
intermed_gene_presence_absence_consensus_2001 <- readRDS(file = "intermed_gene_presence_absence_consensus_2001.rds")
intermed_gene_presence_absence_consensus_2004 <- readRDS(file = "intermed_gene_presence_absence_consensus_2004.rds")
intermed_gene_presence_absence_consensus_2007 <- readRDS(file = "intermed_gene_presence_absence_consensus_2007.rds")
median(c(0,1))
intermed_gene_presence_absence <- readRDS(file = "intermed_gene_presence_absence.rds")
intermed_gene_presence_absence_2001 <- readRDS(file = "intermed_gene_presence_absence_2001.rds")
intermed_gene_presence_absence_2004 <- readRDS(file = "intermed_gene_presence_absence_2004.rds")
intermed_gene_presence_absence_2007 <- readRDS(file = "intermed_gene_presence_absence_2007.rds")
#Compute consensus genomes for sequence clusters
Mass_seq_clusters_dict <- Mass_Samples_accCodes$SequenceCluster
names(Mass_seq_clusters_dict) <- Mass_Samples_accCodes$`Isolate Name`
intermed_gene_presence_absence_consensus <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
# Find intermediate frequency genes in 2001 data set
# compute gene frequencies
sum_as_int <- function(x){
sum(as.integer(x))
}
gene_freq_2001 <- rep(0, nrow(gene_presence_absence_2001)-1)
gene_freq_2001 <- apply(gene_presence_absence_2001[-1,-1],1, sum_as_int)
gene_freq_2001 <- gene_freq_2001 / (length(gene_presence_absence_2001[1,-1]))
cog_filter <- as.integer(gene_freq_2001<=0.95 & gene_freq_2001>=0.05)
#Compute consensus genomes for sequence clusters
Mass_seq_clusters_dict <- Mass_Samples_accCodes$SequenceCluster
names(Mass_seq_clusters_dict) <- Mass_Samples_accCodes$`Isolate Name`
intermed_gene_presence_absence_consensus <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2001 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2001[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2004 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2004[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
intermed_gene_presence_absence_consensus_2007 <- data.frame(matrix(0, nrow = sum(cog_filter)+1, ncol = length(unique(Mass_Samples_accCodes$SequenceCluster))+1))
intermed_gene_presence_absence_consensus_2007[1,-1] <- paste("SeqCl_",unique(Mass_Samples_accCodes$SequenceCluster),sep = "")
cons_genomes <- function(x){
as.double(ceiling(median(as.integer(x))))
}
for (i in unique(Mass_Samples_accCodes$SequenceCluster)) {
intermed_gene_presence_absence_consensus[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2001[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2001[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2001[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2004[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2004[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2004[1,-1])]==i)]), 1, cons_genomes)
intermed_gene_presence_absence_consensus_2007[-1,i+2] <- apply(as.matrix(intermed_gene_presence_absence_2007[-1,c(FALSE,Mass_seq_clusters_dict[unlist(intermed_gene_presence_absence_2007[1,-1])]==i)]), 1, cons_genomes)
}
intermed_gene_presence_absence_consensus[-1,1] <- intermed_gene_presence_absence[-1,1]
intermed_gene_presence_absence_consensus_2001[-1,1] <- intermed_gene_presence_absence[-1,1]
intermed_gene_presence_absence_consensus_2004[-1,1] <- intermed_gene_presence_absence[-1,1]
intermed_gene_presence_absence_consensus_2007[-1,1] <- intermed_gene_presence_absence[-1,1]
#save intermed gene presence absence matrices
saveRDS(intermed_gene_presence_absence_consensus, file = "intermed_gene_presence_absence_consensus.rds")
saveRDS(intermed_gene_presence_absence_consensus_2001, file = "intermed_gene_presence_absence_consensus_2001.rds")
saveRDS(intermed_gene_presence_absence_consensus_2004, file = "intermed_gene_presence_absence_consensus_2004.rds")
saveRDS(intermed_gene_presence_absence_consensus_2007, file = "intermed_gene_presence_absence_consensus_2007.rds")
View(intermed_gene_presence_absence_consensus)
View(intermed_gene_presence_absence_consensus_2001)
# read in gene presence absence matrix
intermed_gene_presence_absence_consensus <- readRDS(file = "intermed_gene_presence_absence_consensus.rds")
intermed_gene_presence_absence_consensus_2001 <- readRDS(file = "intermed_gene_presence_absence_consensus_2001.rds")
intermed_gene_presence_absence_consensus_2004 <- readRDS(file = "intermed_gene_presence_absence_consensus_2004.rds")
intermed_gene_presence_absence_consensus_2007 <- readRDS(file = "intermed_gene_presence_absence_consensus_2007.rds")
subset(Mass_Samples_accCodes,Mass_Samples_accCodes$SequenceCluster == i-1)$VT
Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0]
Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,]
Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]
Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]=="VT"
as.int(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]=="VT")
as.integer(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]=="VT")
ceiling(median(as.integer(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]=="VT"))
)
(median(as.integer(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == 0,"Vaccine Type"]=="VT"))
)
for (i in 1:mass_clusters){
mass_VT[i] <- ceiling(median(as.integer(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == i-1,"Vaccine Type"]=="VT")))
}
# calculate Vaccine Type consensus for clusters
mass_clusters <- length(unique(Mass_Samples_accCodes$SequenceCluster))
mass_VT <- rep(0, mass_clusters)
for (i in 1:mass_clusters){
mass_VT[i] <- ceiling(median(as.integer(Mass_Samples_accCodes[Mass_Samples_accCodes$SequenceCluster == i-1,"Vaccine Type"]=="VT")))
}
mass_VT
