likelihood_grid2 <- gridSearch(sigma_f_vals = ((10:30)/200), prop_f_vals = ((70:90)/200))
rownames(likelihood_grid2) <- ((10:30)/20)
colnames(likelihood_grid2) <- ((70:90)/200)
max(likelihood_grid2)
View(likelihood_grid2)
rownames(likelihood_grid2) <- ((10:30)/200)
colnames(likelihood_grid2) <- ((70:90)/200)
View(likelihood_grid2)
# max: -232.2814 for sigma_f_vals = 0.105, prop_f_vals = 0.38
saveRDS(likelihood_grid2,"likelihood_grid2.rds")
View(likelihood_grid)
((10:30)/200)
((60:80)/200)
((30:50)/200))
((30:50)/200)
exp(-2.3512797)
exp(-454.9737132)
exp(-4.7641440 )
# make grid around 2nd max values
likelihood_grid3 <- gridSearch(sigma_f_vals = ((60:80)/200), prop_f_vals = ((30:50)/200))
exp(3)
rownames(likelihood_grid3) <- ((60:80)/200)
colnames(likelihood_grid3) <- ((30:50)/200))
colnames(likelihood_grid3) <- ((30:50)/200)
# max: -232.2814 for sigma_f_vals = 0.105, prop_f_vals = 0.38
saveRDS(likelihood_grid3,"likelihood_grid3.rds")
View(likelihood_grid3)
max(likelihood_grid3)
plot(as.numeric(rownames(likelihood_grid)), as.numeric(colnames(likelihood_grid)), xlab = "sigma_f", ylab = "prop_f", xaxt='n')
a <- data.frame( x=rnorm(20000, 10, 1.9), y=rnorm(20000, 10, 1.2) )
b <- data.frame( x=rnorm(20000, 14.5, 1.9), y=rnorm(20000, 14.5, 1.9) )
c <- data.frame( x=rnorm(20000, 9.5, 1.9), y=rnorm(20000, 15.5, 1.9) )
data <- rbind(a,b,c)
View(data)
grid_results_df <- data.frame(matrix(0, nrow = 400, ncol = 3))
colnames(grid_results_df) <- c("sigma_f","prop_f","likelihood")
grid_results_df <- rep(((1:20)/20),20)
grid_results_df <- data.frame(matrix(0, nrow = 400, ncol = 3))
colnames(grid_results_df) <- c("sigma_f","prop_f","likelihood")
grid_results_df$sigma_f <- rep(((1:20)/20),20)
(1:20)/20)
(1:20)/20
rep(((1:20)/20),20)
(1:20)/20)
(1:20)/20
(1:20)/20[rep(1,20)]
((1:20)/20)[rep(1,20)]
((1:20)/20)[rep(1,20):rep(20,20)]
sort(((1:20)/20))
sort(rep(((1:20)/20),20))
grid_results_df$prop_f <- sort(rep(((1:20)/20),20))
c(likelihood_grid[,1:3])
likelihood_grid[,1]
c(likelihood_grid[,1],likelihood_grid[,2])
grid_results_df$likelihood <- c(likelihood_grid[,1],likelihood_grid[,2],likelihood_grid[,3],likelihood_grid[,4], likelihood_grid[,5],likelihood_grid[,6],likelihood_grid[,7],likelihood_grid[,8], likelihood_grid[,9],likelihood_grid[,10], likelihood_grid[,11],likelihood_grid[,12], likelihood_grid[,13],likelihood_grid[,14], likelihood_grid[,15],likelihood_grid[,16], likelihood_grid[,17],likelihood_grid[,18], likelihood_grid[,19],likelihood_grid[,20],)
grid_results_df$likelihood <- c(likelihood_grid[,1],likelihood_grid[,2],likelihood_grid[,3],likelihood_grid[,4], likelihood_grid[,5],likelihood_grid[,6],likelihood_grid[,7],likelihood_grid[,8], likelihood_grid[,9],likelihood_grid[,10], likelihood_grid[,11],likelihood_grid[,12], likelihood_grid[,13],likelihood_grid[,14], likelihood_grid[,15],likelihood_grid[,16], likelihood_grid[,17],likelihood_grid[,18], likelihood_grid[,19],likelihood_grid[,20])
View(grid_results_df)
View(likelihood_grid)
ggplot(grid_results_df, aes(x="sigma_f", y="prop_f") ) +
geom_point()
library(ggplot2)
ggplot(grid_results_df, aes(x="sigma_f", y="prop_f") ) +
geom_point()
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point()
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point() +
scale_fill_continuous(type = "viridis")
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = exp(likelihood)))
exp(-389.2107)
exp(-2409.9099)
log(-2409.9099)
log(2409.9099)
log(389.2107)
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = log(-likelihood)))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood),type = "viridis")
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood,type = "viridis"))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(fill = likelihood,))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df[1:200], aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df[1:200,], aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df[1:200,], aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = log(-likelihood)))
grid_results_df2 <- data.frame(matrix(0, nrow = 400, ncol = 3))
colnames(grid_results_df2) <- c("sigma_f","prop_f","likelihood")
grid_results_df2$sigma_f <- rep(((1:20)/20),20)
grid_results_df2$prop_f <- sort(rep(((1:20)/20),20))
grid_results_df2$likelihood <- c(likelihood_grid2[,1],likelihood_grid2[,2],likelihood_grid2[,3],likelihood_grid2[,4], likelihood_grid2[,5],likelihood_grid2[,6],likelihood_grid2[,7],likelihood_grid2[,8], likelihood_grid2[,9],likelihood_grid2[,10], likelihood_grid2[,11],likelihood_grid2[,12], likelihood_grid2[,13],likelihood_grid2[,14], likelihood_grid2[,15],likelihood_grid2[,16], likelihood_grid2[,17],likelihood_grid2[,18], likelihood_grid2[,19],likelihood_grid2[,20])
length(rep(((10:30)/200)))
length((10:30)/200))
length((10:30)/200)
length((70:90)/200))
length((70:90)/200)
21*21
grid_results_df2 <- data.frame(matrix(0, nrow = 441, ncol = 3))
colnames(grid_results_df2) <- c("sigma_f","prop_f","likelihood")
grid_results_df2$sigma_f <- rep(((10:30)/200),21)
grid_results_df2$prop_f <- sort(rep(((70:90)/200),21))
grid_results_df2$likelihood <- c(likelihood_grid2[,1],likelihood_grid2[,2],likelihood_grid2[,3],likelihood_grid2[,4], likelihood_grid2[,5],likelihood_grid2[,6],likelihood_grid2[,7],likelihood_grid2[,8], likelihood_grid2[,9],likelihood_grid2[,10], likelihood_grid2[,11],likelihood_grid2[,12], likelihood_grid2[,13],likelihood_grid2[,14], likelihood_grid2[,15],likelihood_grid2[,16], likelihood_grid2[,17],likelihood_grid2[,18], likelihood_grid2[,19],likelihood_grid2[,20])
grid_results_df2$likelihood <- c(likelihood_grid2[,1],likelihood_grid2[,2],likelihood_grid2[,3],likelihood_grid2[,4], likelihood_grid2[,5],likelihood_grid2[,6],likelihood_grid2[,7],likelihood_grid2[,8], likelihood_grid2[,9],likelihood_grid2[,10], likelihood_grid2[,11],likelihood_grid2[,12], likelihood_grid2[,13],likelihood_grid2[,14], likelihood_grid2[,15],likelihood_grid2[,16], likelihood_grid2[,17],likelihood_grid2[,18], likelihood_grid2[,19],likelihood_grid2[,20], likelihood_grid2[,21])
ggplot(grid_results_df2, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
exp(-5)
exp(10)
exp(-10 + 0.004 *  ((ggC_delta_ranking)))
plot(exp(-10 + 0.004 *  ((ggC_delta_ranking))))
plot(ggC_delta_data3)
points(exp(-10 + 0.004 *  ((ggC_delta_ranking))),col="red")
plot((sort(0.5 - ggC_delta_data3)))
points(sort(0.5 - exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
points((0.5 - exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
plot(((ggC_delta_data3)))
points(exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking))), col = "red")
plot((sort(0.5 - ggC_delta_data3)))
points(sort(0.5 - exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
plot((sort(0.5 - 10 * ggC_delta_data3)))
points(sort(0.5 - 10 *exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
points(sort(exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
plot(sort(0.5 - 10 *exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
plot(sort(0.5 - exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
points(sort(0.5 - exp(-10.338049) * exp(0.004083 *  ((ggC_delta_ranking)))), col = "blue")
points(sort(0.5 - exp(-100.338049) * exp(0.004083 *  ((ggC_delta_ranking)))), col = "blue")
points(sort(0.5 - exp(-1.338049) * exp(0.004083 *  ((ggC_delta_ranking)))), col = "blue")
plot(sort(0.05 - exp(-62 + 0.05 *  ((ggC_delta_ranking))))
)
WF_exp <- odin.dust::odin_dust("NFDS_Model_exp.R")
exp_ggCPP_params <- list(dt = 1/36, species_no = PP_mass_clusters,  gene_no = nrow(ggCPP_intermed_gene_presence_absence_consensus)-1, Pop_ini = as.double(PP_model_start_pop), Pop_eq = as.double(PP_model_start_pop), capacity = sum(PP_model_start_pop), Genotypes = ggCPP_intermed_gene_presence_absence_consensus_matrix, L = 0, x0 = -10, K = 0.004, delta = ggC_delta_ranking, m = 0.0078524723, migVec = PP_avg_cluster_freq, vaccTypes = PP_mass_VT, v =0.1103623064, vacc_time = 0)
WFmodel_exp <- WF_exp$new(pars = exp_ggCPP_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WFmodel_exp <- WF_exp$new(pars = exp_ggCPP_params,
time = 1,
n_particles = 10L,
n_threads = 4L,
seed = 1L)
WFmodel_exp$run(2)
log(0)
log(0)
log(-10)
exp(-10)
plot((sort(0.5 - ggC_delta_data3)))
points(sort(0.5 - 10 *exp(-10.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "red")
log(10)
points(sort(0.5 - exp(-8.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "blue")
points(sort(0.5 - exp(-1.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "blue")
points(sort(0.5 - exp(-5.338049 + 0.004083 *  ((ggC_delta_ranking)))), col = "blue")
exp(-5)
exp(-10)
exp(-1)
ggplot(grid_results_df, aes(sigma_f, prop_f)) +
geom_density_2d()
library(ggplot2)
ggplot(grid_results_df, aes(sigma_f, prop_f)) +
geom_density_2d()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = likelihood))
v + geom_contour()
v + geom_contour_filled()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(abslikelihood))))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(abs(likelihood))))
v + geom_contour_filled()
log(5.4)
exp(5.4)
v + geom_contour_filled() + scale_color_viridis(option = "D")
v + geom_contour_filled() + scale_color_continuous(labels = comma)
v + geom_contour_filled(labels = likelihood)
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = likelihood))
v + geom_contour_filled()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(abs(likelihood))))
v + geom_contour_filled()
ggplot(grid_results_df2, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = (likelihood))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = log(abs(likelihood))))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled()
grid_results_df2$sigma_f
unique(grid_results_df2$sigma_f)
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + scale_x_discrete(breaks = unique(grid_results_df2$sigma_f))
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + scale_x_discrete(labels = unique(grid_results_df2$sigma_f))
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + scale_x_discrete(limits = unique(grid_results_df2$sigma_f))
v + geom_contour_filled() + scale_x_discrete(labels = as.character(unique(grid_results_df2$sigma_f)))
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + scale_x_discrete(breaks = as.character(unique(grid_results_df2$sigma_f)))
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_discrete(breaks = as.character(unique(grid_results_df2$sigma_f)))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_discrete(breaks = as.character(unique(grid_results_df2$sigma_f)), labels = as.character(unique(grid_results_df2$sigma_f)))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = as.character(unique(grid_results_df2$sigma_f)), labels = as.character(unique(grid_results_df2$sigma_f)))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df2$sigma_f)))
v + geom_contour_filled()
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(sigma_f))) + scale_y_continuous(breaks = (unique(prop_f)))
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df2$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df2$prop_f)))
v + geom_contour_filled()
View(likelihood_grid3)
View(likelihood_grid3)
max(likelihood_grid3)
nrow(likelihood_grid3)
ncol(likelihood_grid3)
grid_results_df3 <- data.frame(matrix(0, nrow = 441, ncol = 3))
colnames(grid_results_df3) <- c("sigma_f","prop_f","likelihood")
grid_results_df3$sigma_f <- rep(((60:80)/200),21)
grid_results_df3$prop_f <- sort(rep(((30:50)/200),21))
grid_results_df3$likelihood <- c(likelihood_grid3[,1],likelihood_grid3[,2],likelihood_grid3[,3],likelihood_grid3[,4], likelihood_grid3[,5],likelihood_grid3[,6],likelihood_grid3[,7],likelihood_grid3[,8], likelihood_grid3[,9],likelihood_grid3[,10], likelihood_grid3[,11],likelihood_grid3[,12], likelihood_grid3[,13],likelihood_grid3[,14], likelihood_grid3[,15],likelihood_grid3[,16], likelihood_grid3[,17],likelihood_grid3[,18], likelihood_grid3[,19],likelihood_grid3[,20], likelihood_grid3[,21])
ggplot(grid_results_df3, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(color = likelihood))
ggplot(grid_results_df3, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = (likelihood))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
ggplot(grid_results_df3, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = (likelihood))) +
scale_size_continuous(range = c(3, 7))
library(viridis)
ggplot(grid_results_df3, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = (likelihood))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
v <- ggplot(grid_results_df3, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df3$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df3$prop_f)))
v + geom_contour_filled()
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(abs(likelihood))))
v + geom_contour_filled() + + labs(fill = "log abs Likelihood") + theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(abs(likelihood))))
v + geom_contour_filled() + labs(fill = "log abs Likelihood") + theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 10),
legend.text = element_text(size = 8))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 10),legend.text = element_text(size = 8), axis.title = element_text(size = 10))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 10),legend.text = element_text(size = 12), axis.title = element_text(size = 12))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 10),legend.text = element_text(size = 12), axis.title = element_text(size = 12),axis.ticks = element_text(size = 12))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 10),legend.text = element_text(size = 12), axis.title = element_text(size = 12),axis.text = element_text(size = 12))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 12),legend.text = element_text(size = 12), axis.title = element_text(size = 12),axis.text = element_text(size = 12))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + labs(fill = "Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = -likelihood))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(max(grid_results_df$likelihood),aes(colour = "red"))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(max(grid_results_df$likelihood),colour = "red")
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(max(grid_results_df$likelihood))
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(aes(x=0.105, y=0.38), colour="red")
v <- ggplot(grid_results_df, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(aes(x=0.1, y=0.4), colour="red") + + geom_point(aes(x= 0.35, y=0.2), colour="orange")
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(aes(x=0.1, y=0.4), colour="red") + geom_point(aes(x= 0.35, y=0.2), colour="orange")
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(aes(x=0.1, y=0.4), colour="red") + geom_point(aes(x= 0.35, y=0.2), colour="orange", size = 3)
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16)) + geom_point(aes(x=0.1, y=0.4), colour="red", size = 3) + geom_point(aes(x= 0.35, y=0.2), colour="orange", size = 3)
v <- ggplot(grid_results_df2, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df2$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df2$prop_f)))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 16))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
v <- ggplot(grid_results_df3, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df3$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df3$prop_f)))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
# path to results:
results_path_15 <- "/Users/llorenz/Documents/PhD_Project/Code/1st_project/WF_plots_postTAC/2024_04_15/"
ggCPP_det_mcmc2 <- readRDS(paste(results_path_15, "ggCaller_PopPUNK_det_mcmc2.rds",sep=""))
plot(coda::as.mcmc(ggCPP_det_mcmc2[1001:20000,]))
library(tigerstats)
combinedchains2 = coda::mcmc.list(coda::as.mcmc(ggCPP_det_mcmc2[1001:20000,-c(1,3)]), coda::as.mcmc(ggCPP_det_mcmc2[21001:40000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[41001:60000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[61001:80000,-c(1,3)]))
xyplot(combinedchains2)
# prop_f and sigma_f
plot(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6])
lines(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6], col = "grey")
points(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6])
# prop_f and sigma_f
plot(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6], ylab = "prop_f",xlab = "sigma_f")
lines(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6], col = "grey")
points(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,6])
# sigma_w and sigma_f
plot(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,5], xlim = c(0, 0.35))
lines(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,5], col = "grey")
points(ggCPP_det_mcmc2[1001:20000,4],ggCPP_det_mcmc2[1001:20000,5])
# 5 params
results_path_19 <- "/Users/llorenz/Documents/PhD_Project/Code/1st_project/WF_plots_postTAC/2024_04_19/"
log_ggCPP_pmcmc2_19 <- readRDS(paste(results_path_19, "ggCaller_PopPUNK_log_det_pmcmc_run2_FittingExp.rds",sep=""))
log_ggCPP_pmcmc2_FittingExp <- readRDS(paste(results_path_19, "ggCaller_PopPUNK_log_det_pmcmc_run2_FittingExp.rds",sep=""))
head(log_ggCPP_pmcmc2_FittingExp)
summary(log_ggCPP_pmcmc2_FittingExp)
log_ggCPP_pmcmc2_FittingExp_coda <- coda::as.mcmc(cbind(
log_ggCPP_pmcmc2_FittingExp$probabilities, log_ggCPP_pmcmc2_FittingExp$pars))
mcmc2
summary(log_ggCPP_pmcmc2_FittingExp_coda)
exp(-2.3392)
exp(0.29739)
log(0.29739)
summary(ggCPP_det_mcmc2)
1.178e-01
summary(ggCPP_det_mcmc2[c(1001:20000,21001:40000,41001:60000,61001:80000),])
summary(coda::as.mcmc(ggCPP_det_mcmc2[c(1001:20000,21001:40000,41001:60000,61001:80000),]))
plot(ggCPP_det_mcmc2)
plot(ggCPP_det_mcmc2)
library(tigerstats)
combinedchains2 = coda::mcmc.list(coda::as.mcmc(ggCPP_det_mcmc2[1001:20000,-c(1,3)]), coda::as.mcmc(ggCPP_det_mcmc2[21001:40000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[41001:60000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[61001:80000,-c(1,3)]))
xyplot(combinedchains2)
combinedchains2 = coda::mcmc.list(coda::as.mcmc(ggCPP_det_mcmc2[1:20000,-c(1,3)]), coda::as.mcmc(ggCPP_det_mcmc2[20001:40000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[40001:60000,-c(1,3)]),coda::as.mcmc(ggCPP_det_mcmc2[60001:80000,-c(1,3)]))
xyplot(combinedchains2)
summary(coda::as.mcmc(ggCPP_det_mcmc2[c(5001:20000,25001:40000,45001:60000,65001:80000),]))
#                     Mean        SD  Naive SE Time-series SE
#log_prior       0.000e+00 0.0000000 0.000e+00      0.0000000
#log_likelihood -2.633e+02 2.1542694 8.795e-03      0.0725237
#log_posterior  -2.633e+02 2.1542694 8.795e-03      0.0725237
#sigma_f         1.109e-01 0.0292186 1.193e-04      0.0009632
#sigma_w         3.823e-04 0.0003979 1.625e-06      0.0000128
#prop_f          3.861e-01 0.0451591 1.844e-04      0.0013191
#m               1.101e-02 0.0043000 1.755e-05      0.0001459
#v               1.466e-01 0.0254677 1.040e-04      0.0008980
summa_ggCPP_run <- summary(coda::as.mcmc(ggCPP_det_mcmc2[c(5001:20000,25001:40000,45001:60000,65001:80000),]))
summa_ggCPP_run$statistics
summa_ggCPP_run$statistics[,1]
plot(summa_ggCPP_run$statistics[,1])
plot(summa_ggCPP_run$statistics[-(1:3),1])
summa_ggCPP_run_df <- data.frame(summa_ggCPP_run$statistics)
View(summa_ggCPP_run_df)
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df)
summa_ggCPP_run_df <- data.frame(summa_ggCPP_run$statistics[-(1:3),1])
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df)
summa_ggCPP_run_df <- data.frame(summa_ggCPP_run$statistics[-(1:3),])
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df)
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
summa_ggCPP_run$statistics
summa_ggCPP_run_df <- data.frame(cbind(summa_ggCPP_run$statistics[-(1:3),], rownames(summa_ggCPP_run$statistics[-(1:3)])))
View(summa_ggCPP_run_df)
summa_ggCPP_run_df <- data.frame(cbind(summa_ggCPP_run$statistics[-(1:3),], rownames(summa_ggCPP_run$statistics[-(1:3)])))
View(summa_ggCPP_run_df)
View(summa_ggCPP_run_df)
cbind(summa_ggCPP_run$statistics[-(1:3),], rownames(summa_ggCPP_run$statistics[-(1:3)]))
rownames(summa_ggCPP_run$statistics[-(1:3)])
summa_ggCPP_run$statistics
rowNames(summa_ggCPP_run$statistics)
rownames(summa_ggCPP_run$statistics)
rownames(summa_ggCPP_run$statistics)[-(1:3)]
summa_ggCPP_run_df <- data.frame(cbind(summa_ggCPP_run$statistics[-(1:3),], rownames(summa_ggCPP_run$statistics)[-(1:3)]))
View(summa_ggCPP_run_df)
qplot(x    = V5 ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
summa_ggCPP_run_df <- data.frame(summa_ggCPP_run$statistics[-(1:3),])
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
qplot(x    = rownames(summa_ggCPP_run_df) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
rownames(summa_ggCPP_run_df)
qplot(x    = factor(rownames(summa_ggCPP_run_df)) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
qplot(x    = factor(rownames(summa_ggCPP_run_df)) ,
y    = Mean,
data = summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = summa_ggCPP_run_df$Mean - summa_ggCPP_run_df$SD,
ymax  = summa_ggCPP_run_df$Mean + summa_ggCPP_run_df$SD,
width = 0.15))
factor(rownames(summa_ggCPP_run_df))
# 5 params
results_path <- "/Users/llorenz/Documents/PhD_Project/Code/1st_project/WF_plots_postTAC/2024_04_16/"
log_ggCPP_pmcmc2 <- readRDS(paste(results_path, "ggCaller_PopPUNK_log_det_pmcmc_run2.rds",sep=""))
log_ggCPP_det_mcmc2 <- coda::as.mcmc(cbind(log_ggCPP_pmcmc2$probabilities, log_ggCPP_pmcmc2$pars))
log_summa_ggCPP_run <- summary(coda::as.mcmc(log_ggCPP_det_mcmc2[c(5001:20000,25001:40000,45001:60000,65001:80000),]))
log_summa_ggCPP_run_df <- data.frame(log_summa_ggCPP_run$statistics[-(1:3),])
qplot(x    = factor(rownames(log_summa_ggCPP_run_df)) ,
y    = Mean,
data = log_summa_ggCPP_run_df) +
geom_errorbar(aes(ymin  = log_summa_ggCPP_run_df$Mean - log_summa_ggCPP_run_df$SD,
ymax  = log_summa_ggCPP_run_df$Mean + log_summa_ggCPP_run_df$SD,
width = 0.15))
log_summa_ggCPP_run$statistics
plot(0.11453196/(1 + exp(- 5.05771048 * (1:1774 - 1774*(0.62597904)))))
lines(0.11453196/(1 + exp(- 2 * (1:1774 - 1774*(0.62597904)))), col = "red")
plot(0.11453196/(1 + exp(- 5.05771048 * (1:1774 - 1774*(0.62597904)))))
points(0.11453196/(1 + exp(- 2 * (1:1774 - 1774*(0.62597904)))), col = "red")
points(0.11453196/(1 + exp(- 8 * (1:1774 - 1774*(0.62597904)))), col = "red")
points(0.11453196/(1 + exp(- 8 * (1:1774 - 1774*(0.62597904)))), col = "blue")
plot(0.11453196/(1 + exp(- 5.05771048 * (1:1774 - 1774*(0.62597904)))))
points(0.11453196/(1 + exp(- 2 * (1:1774 - 1774*(0.62597904)))), col = "red")
points(0.11453196/(1 + exp(- 8 * (1:1774 - 1774*(0.62597904)))), col = "blue")
plot(log_ggCPP_pmcmc2_FittingExp)
# 5 params
results_path_19 <- "/Users/llorenz/Documents/PhD_Project/Code/1st_project/WF_plots_postTAC/2024_04_19/"
log_ggCPP_pmcmc2_FittingExp <- readRDS(paste(results_path_19, "ggCaller_PopPUNK_log_det_pmcmc_run2_FittingExp.rds",sep=""))
summary(log_ggCPP_pmcmc2_FittingExp)
log_ggCPP_pmcmc2_FittingExp_coda <- coda::as.mcmc(cbind(
log_ggCPP_pmcmc2_FittingExp$probabilities, log_ggCPP_pmcmc2_FittingExp$pars))
summary(log_ggCPP_pmcmc2_FittingExp_coda)
plot(log_ggCPP_pmcmc2_FittingExp_coda)
exp(-5)
exp(10)
plot(0.11453196/(1 + exp(- 22026 * (1:1774 - 1774*(0.62597904)))))
plot(0.11453196/(1 + exp(5 * (1:1774 - 1774*(0.62597904)))))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
library(ggplot2)
library(viridis)
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
likelihood_grid4 <- readRDS("likelihood_grid4.rds")
grid_results_df4$likelihood <- c(likelihood_grid4[,1],likelihood_grid4[,2],likelihood_grid4[,3],likelihood_grid4[,4], likelihood_grid4[,5],likelihood_grid4[,6],likelihood_grid4[,7],likelihood_grid4[,8], likelihood_grid4[,9],likelihood_grid4[,10], likelihood_grid4[,11],likelihood_grid4[,12], likelihood_grid4[,13],likelihood_grid4[,14], likelihood_grid4[,15],likelihood_grid4[,16], likelihood_grid4[,17],likelihood_grid4[,18], likelihood_grid4[,19],likelihood_grid4[,20], likelihood_grid4[,21],
likelihood_grid4[,22],likelihood_grid4[,23],likelihood_grid4[,24],likelihood_grid4[,25], likelihood_grid4[,26],likelihood_grid4[,27],likelihood_grid4[,28],likelihood_grid4[,29], likelihood_grid4[,30],likelihood_grid4[,31],
likelihood_grid4[,32], likelihood_grid4[,33],likelihood_grid4[,34], likelihood_grid4[,35],likelihood_grid4[,36], likelihood_grid4[,37],likelihood_grid4[,38], likelihood_grid4[,39],likelihood_grid4[,40], likelihood_grid4[,41],likelihood_grid4[,42],likelihood_grid4[,43],likelihood_grid4[,44],likelihood_grid4[,45], likelihood_grid4[,46],likelihood_grid4[,47],likelihood_grid4[,48],likelihood_grid4[,49])
grid_results_df4 <- data.frame(matrix(0, nrow = 2009, ncol = 3))
colnames(grid_results_df4) <- c("sigma_f","prop_f","likelihood")
grid_results_df4$sigma_f <- rep(((0:40)/100),49)
grid_results_df4$prop_f <- sort(rep((12:60)/100,41))
grid_results_df4$likelihood <- c(likelihood_grid4[,1],likelihood_grid4[,2],likelihood_grid4[,3],likelihood_grid4[,4], likelihood_grid4[,5],likelihood_grid4[,6],likelihood_grid4[,7],likelihood_grid4[,8], likelihood_grid4[,9],likelihood_grid4[,10], likelihood_grid4[,11],likelihood_grid4[,12], likelihood_grid4[,13],likelihood_grid4[,14], likelihood_grid4[,15],likelihood_grid4[,16], likelihood_grid4[,17],likelihood_grid4[,18], likelihood_grid4[,19],likelihood_grid4[,20], likelihood_grid4[,21],
likelihood_grid4[,22],likelihood_grid4[,23],likelihood_grid4[,24],likelihood_grid4[,25], likelihood_grid4[,26],likelihood_grid4[,27],likelihood_grid4[,28],likelihood_grid4[,29], likelihood_grid4[,30],likelihood_grid4[,31],
likelihood_grid4[,32], likelihood_grid4[,33],likelihood_grid4[,34], likelihood_grid4[,35],likelihood_grid4[,36], likelihood_grid4[,37],likelihood_grid4[,38], likelihood_grid4[,39],likelihood_grid4[,40], likelihood_grid4[,41],likelihood_grid4[,42],likelihood_grid4[,43],likelihood_grid4[,44],likelihood_grid4[,45], likelihood_grid4[,46],likelihood_grid4[,47],likelihood_grid4[,48],likelihood_grid4[,49])
ggplot(grid_results_df4, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = (likelihood))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
ggplot(grid_results_df4, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = log(-(likelihood)))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
ggplot(grid_results_df4, aes(x=sigma_f, y=prop_f) ) +
geom_point(aes(size = (likelihood),color = -log(-(likelihood)))) +
scale_size_continuous(range = c(3, 7)) +
scale_color_viridis(option = "D")
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df4$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df4$prop_f)))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12)) +scale_size_continuous(range = c(3, 7))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = -log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
exp(5.4)
exp(5.6)
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = -likelihood)) + scale_x_continuous(breaks = (unique(grid_results_df4$sigma_f))) + scale_y_continuous(breaks = (unique(grid_results_df4$prop_f)))
v + geom_contour_filled() + labs(fill = "- Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12)) + ylim(c(0.1,0.5))
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = 2 * log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
exp(10.5/2)
exp(11.5/2)
exp(11.5)/2
# do log!
v <- ggplot(grid_results_df4, aes(sigma_f, prop_f, z = log(-(likelihood))))
v + geom_contour_filled() + labs(fill = "log neg Likelihood") + theme(legend.title = element_text(size = 16),legend.text = element_text(size = 16), axis.title = element_text(size = 16),axis.text = element_text(size = 12))
