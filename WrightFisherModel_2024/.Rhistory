data_2=as.numeric(data2 / sum(data2))
)
lollipop_data_3 <- data.frame(
x=1:length(data3),
model_3=model3 / sum(model3),
data_3=as.numeric(data3 / sum(data3))
)
# Change baseline
lollipop_plot_1 <- ggplot(lollipop_data_1) +
geom_segment( aes(x=x, xend=x, y=model_1, yend=data_1), color="grey") +
geom_point( aes(x=x, y=model_1, color="Model non-VT"), size=3 ) +
geom_point( aes(x=x, y=data_1, color="Data non_VT"), size=3 ) +
scale_color_manual(values = c("#E69F00", "#56B4E9"),
guide  = guide_legend(),
name   = "Group") +
coord_flip()+
#theme_ipsum() +
theme(legend.position = "none") +
ggtitle("2001") +
ylab("Frequency") +
xlab("Clusters") +
theme(axis.title  = element_text(size = 20), axis.text = element_text(size = 20), plot.title = element_text(size = 25,hjust = 0.5))  +
ylim(0, max(max(lollipop_data_1$model_1),max(lollipop_data_1$data_1),max(lollipop_data_2$model_2),max(lollipop_data_2$data_2),max(lollipop_data_3$model_3),max(lollipop_data_3$data_3)))
lollipop_plot_2 <- ggplot(lollipop_data_2) +
geom_segment( aes(x=x, xend=x, y=model_2, yend=data_2), color="grey") +
geom_point( aes(x=x, y=model_2, color="Model"), size=3 ) +
geom_point( aes(x=x, y=data_2, color="Data"), size=3 ) +
scale_color_manual(values = c("#E69F00", "#56B4E9"),
guide  = guide_legend(),
name   = "Group") +
coord_flip()+
#theme_ipsum() +
theme(legend.position = "none") +
ggtitle("2004") +
ylab("Frequency") +
xlab("Clusters") +
theme(axis.title  = element_text(size = 20), axis.text = element_text(size = 20), plot.title = element_text(size = 25,hjust = 0.5))  +
ylim(0, max(max(lollipop_data_1$model_1),max(lollipop_data_1$data_1),max(lollipop_data_2$model_2),max(lollipop_data_2$data_2),max(lollipop_data_3$model_3),max(lollipop_data_3$data_3)))
lollipop_plot_3 <- ggplot(lollipop_data_3) +
geom_segment( aes(x=x, xend=x, y=model_3, yend=data_3), color="grey") +
geom_point( aes(x=x, y=model_3, color="Model"), size=3 ) +
geom_point( aes(x=x, y=data_3, color="Data"), size=3 ) +
scale_color_manual(values = c("#E69F00", "#56B4E9"),
guide  = guide_legend(),
name   = "Legend") +
coord_flip()+
#theme_ipsum() +
theme(legend.position = c(.8,.8),legend.text = element_text(size = 20),legend.title = element_text(size = 20)) +
ggtitle("2007") +
ylab("Frequency") +
xlab("Clusters") +
theme(axis.title  = element_text(size = 20), axis.text = element_text(size = 20), plot.title = element_text(size = 25,hjust = 0.5))  +
ylim(0, max(max(lollipop_data_1$model_1),max(lollipop_data_1$data_1),max(lollipop_data_2$model_2),max(lollipop_data_2$data_2),max(lollipop_data_3$model_3),max(lollipop_data_3$data_3)))
grid.arrange(lollipop_plot_1 + theme(plot.margin = unit(c(.5,0.5,1,0.5), "cm"),axis.text.y = element_blank()) ,lollipop_plot_2 +  theme(plot.margin = unit(c(.5,0.5,1,0.5), "cm"),axis.text.y = element_blank()), lollipop_plot_3 + theme(plot.margin = unit(c(.5,0.5,1,0.5), "cm"),axis.text.y = element_blank()), ncol = 3, nrow=1)
}
# example usage
# simulated data
d1 <- runif(100,min=0,max=1)
d2 <- runif(100,min=0,max=1)
d3 <- runif(100,min=0,max=1)
# simulated model values
m1 <- runif(100,min=0,max=1)
m2 <- runif(100,min=0,max=1)
m3 <- runif(100,min=0,max=1)
lollipop_cluster_freqs(d1,d2,d3,m1,m2,m3)
lollipop_cluster_freqs(d1,d2,d3,m1,m2,m3)
# example usage
# simulated data
d1 <- runif(10,min=0,max=1)
d2 <- runif(10,min=0,max=1)
d3 <- runif(10,min=0,max=1)
# simulated model values
m1 <- runif(10,min=0,max=1)
m2 <- runif(10,min=0,max=1)
m3 <- runif(10,min=0,max=1)
lollipop_cluster_freqs(d1,d2,d3,m1,m2,m3)
path_to_data <- "~/Documents/PhD_Project/Data/"
### Reading in the Accesion Codes, Population and the Sequence Clusters
library(readxl)
Samples_accCodes <- read_excel(paste(path_to_data, "Massachusetts_data_NickCroucher/SupplementaryDataPaper/Samples_accCodes.xlsx", sep = ""))
Mass_Samples_accCodes <- Samples_accCodes[Samples_accCodes$Population=="Massachusetts",]
Mass_Isolates <- Mass_Samples_accCodes$`Isolate Name`
Mass_Isolates_dict <- 1:length(Mass_Isolates)
names(Mass_Isolates_dict) <- Mass_Isolates
Isolates <- Samples_accCodes$`Isolate Name`
Isolates_dict <- 1:length(Isolates)
names(Isolates_dict) <- Isolates
### Reading in the Gene Cluster information
#gene_cluster <- read.delim(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""))
gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ]
split_isolate_name <- function(text_line){
name_vec <- strsplit(strsplit(text_line,">")[[1]][2],"_")
paste(head(name_vec[[1]],-1), collapse = "_")
}
isolates_gene_cluster <- unlist(lapply(gene_cluster, split_isolate_name))
return_isolate_index <- function(name){
Isolates_dict[[name]]
}
indices_gene_clusters <- unlist(lapply(isolates_gene_cluster, return_isolate_index))
gene_cl5 <- rep(0, length(Mass_Isolates))
gene_cl5[indices_gene_clusters] <- 1
# and then create matrix
fils <- list.files(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences", sep = ""), full.names = TRUE, recursive = FALSE)
dirs <- dirname(fils)
dirs
length(fils)
gene_presence_absence <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Isolates)+1))
cls_files <- list.files(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences", sep = ""), full.names = TRUE, recursive = FALSE)
gene_presence_absence <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Isolates)+1))
View(gene_presence_absence)
gene_presence_absence[1,] <- Mass_Isolates
gene_presence_absence[1,-1] <- Mass_Isolates
gene_presence_absence[1,-1]
View(gene_presence_absence)
head(cls_files)
read_cls_file <- function(path_to_file){
read.table(path_to_file, quote="\"", comment.char="")[ c(TRUE,FALSE), ]
}
read_cls_file("/Users/llorenz/Documents/PhD_Project/Data/v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out")
unlist(read_cls_file("/Users/llorenz/Documents/PhD_Project/Data/v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out"))
as.vector(read_cls_file("/Users/llorenz/Documents/PhD_Project/Data/v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out"))
as.vector(read_cls_file("/Users/llorenz/Documents/PhD_Project/Data/v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out"))[1]
as.vector(read_cls_file("/Users/llorenz/Documents/PhD_Project/Data/v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out"))[2]
### Reading in the Gene Cluster information
#gene_cluster <- read.delim(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""))
gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ]
isoates_in_clusters <- lapply(cls_files, read_cls_file)
isoates_in_clusters
View(isoates_in_clusters)
head(cls_files)
isoates_in_clusters[[1]]
isolates_gene_cluster <- unlist(lapply(isoates_in_clusters[[1]], split_isolate_name))
isolates_gene_cluster <- unlist(lapply(isoates_in_clusters, split_isolate_name))
View(isolates_gene_cluster)
isolates_in_clusters <- lapply(cls_files, read_cls_file)
isolates_gene_cluster <- (lapply(isolates_in_clusters, split_isolate_name))
isolates_gene_cluster <- lapply(isolates_in_clusters[[]], split_isolate_name)
isolates_gene_cluster <- lapply(isolates_in_clusters[[1]], split_isolate_name)
isolates_in_clusters <- data.frame(lapply(cls_files, read_cls_file))
isolates_in_clusters <- lapply(cls_files, read_cls_file)
isolates_in_clusters <- unlist(lapply(cls_files, read_cls_file))
View(isolates_gene_cluster)
View(isoates_in_clusters)
View(isolates_in_clusters)
isolates_in_clusters <- (lapply(cls_files, read_cls_file))
View(isoates_in_clusters)
View(isoates_in_clusters)
View(isoates_in_clusters)
length(isolates_in_clusters)
isolates_in_clusters[[1]]
cls_files[1]
strsplit(cls_files[1],"/")
head(strsplit(cls_files[1],"/"),-1)
head(strsplit(cls_files[1],"/")[[1]],-1)
tail(strsplit(cls_files[1],"/")[[1]],1)
strsplit(tail(strsplit(cls_files[1],"/")[[1]],1),".")[[1]][1]
strsplit(tail(strsplit(cls_files[1],"/")[[1]],1),".")
strsplit(tail(strsplit(cls_files[1],"/")[[1]],1),"\.")
strsplit(tail(strsplit(cls_files[1],"/")[[1]],1),"\\.")
strsplit(tail(strsplit(cls_files[1],"/")[[1]],1),"\\.")[[1]][1]
for (i in 1:length(isolates_in_clusters)) {
isolates_gene_cluster <- unlist(lapply(isolates_in_clusters[[i]], split_isolate_name))
indices_gene_clusters <- unlist(lapply(isolates_gene_cluster, return_isolate_index))
help_vector <- rep(0, length(Mass_Isolates))
help_vector[indices_gene_clusters] <- 1
gene_presence_absence[i+1,] <- c(strsplit(tail(strsplit(cls_files[i],"/")[[1]],1),"\\.")[[1]][1], help_vector)
}
length(help_vector)
length(Mass_Isolates)
### Reading in the Gene Cluster information
#gene_cluster <- read.delim(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""))
gene_cluster <- read.table(paste(path_to_data, "v2_Massachusetts_data_NickCroucher/gCOG_sequences/CLS00005.out", sep = ""), quote="\"", comment.char="")[ c(TRUE,FALSE), ]
read_cls_file <- function(path_to_file){
read.table(path_to_file, quote="\"", comment.char="")[ c(TRUE,FALSE), ]
}
split_isolate_name <- function(text_line){
name_vec <- strsplit(strsplit(text_line,">")[[1]][2],"_")
paste(head(name_vec[[1]],-1), collapse = "_")
}
isolates_gene_cluster <- unlist(lapply(gene_cluster, split_isolate_name))
head(isolates_gene_cluster)
View(Mass_Samples_accCodes)
names(Mass_Isolates_dict)
Mass_Isolates_dict["1603456"]
Isolate_from_Mass_dict <- rep(0, length(Isolates))
names(Isolate_from_Mass_dict) <- Isolates
Isolate_from_Mass_dict[Mass_Isolates] <- 1
Isolate_from_Mass_dict
Mass_isolates_gene_cluster[1]
isolates_gene_cluster[1]
Isolate_from_Mass_dict[isolates_gene_cluster[1]]
isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster[1]]==1]
Isolate_from_Mass_dict[isolates_gene_cluster[1]]==1
Isolate_from_Mass_dict[isolates_gene_cluster]==1
isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
Isolate_from_Mass_dict[Mass_isolates_gene_cluster]
indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
for (i in 1:length(isolates_in_clusters)) {
isolates_gene_cluster <- unlist(lapply(isolates_in_clusters[[i]], split_isolate_name))
Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
help_vector <- rep(0, length(Mass_Isolates))
help_vector[indices_gene_clusters] <- 1
gene_presence_absence[i+1,] <- c(strsplit(tail(strsplit(cls_files[i],"/")[[1]],1),"\\.")[[1]][1], help_vector)
}
isolates_gene_cluster <- unlist(lapply(isolates_in_clusters[[1]], split_isolate_name))
Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
indices_gene_clusters
return_isolate_index <- function(name){
Mass_Isolates_dict[[name]]
}
for (i in 1:length(isolates_in_clusters)) {
isolates_gene_cluster <- unlist(lapply(isolates_in_clusters[[i]], split_isolate_name))
Mass_isolates_gene_cluster <- isolates_gene_cluster[Isolate_from_Mass_dict[isolates_gene_cluster]==1]
indices_gene_clusters <- unlist(lapply(Mass_isolates_gene_cluster, return_isolate_index))
help_vector <- rep(0, length(Mass_Isolates))
help_vector[indices_gene_clusters] <- 1
gene_presence_absence[i+1,] <- c(strsplit(tail(strsplit(cls_files[i],"/")[[1]],1),"\\.")[[1]][1], help_vector)
}
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001]
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]
Mass_2001_dict
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,1]
Mass_2001_dict
length(Mass_Samples_accCodes[,1])
length(Mass_Samples_accCodes$`Isolate Name`)
length(unique(Mass_Samples_accCodes$`Isolate Name`))
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001]
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]
Mass_2001_dict
# create time-point specific gene presence absence matrices
Mass_2001_dict <- Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`
Mass_2001_dict
# create time-point specific gene presence absence matrices
Mass_year_dict <- c(rep(2001,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)),
)
# create time-point specific gene presence absence matrices
Mass_year_dict <- c(rep(2001,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)),
rep(2004,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)),
rep(2007,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)))
names(Mass_year_dict) <- c(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
head(Mass_year_dict)
Mass_year_dict[439699]
Mass_year_dict["439699"]
# empty gene presence absence matrix
gene_presence_absence_2001 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
gene_presence_absence[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence[1,-1]
Mass_year_dict[gene_presence_absence[1,-1]]
Mass_year_dict[unlist(gene_presence_absence[1,-1])]
Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001
gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001]
gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001)]
gene_presence_absence_2001[-1,-1] <- gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001]
gene_presence_absence_2001
View(gene_presence_absence_2001)
gene_presence_absence_2004 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
gene_presence_absence_2004[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
gene_presence_absence_2004[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2004[-1,-1] <- gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004]
gene_presence_absence_2007 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
gene_presence_absence_2007 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
gene_presence_absence_2007[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
gene_presence_absence_2007[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2007[-1,-1] <- gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2007]
length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
# create time-point specific gene presence absence matrices
Mass_year_dict <- c(rep(2001,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)),
rep(2004,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)),
rep(2007,length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)))
names(Mass_year_dict) <- c(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`, Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
# empty gene presence absence matrix
gene_presence_absence_2001 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
gene_presence_absence_2001[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2001[-1,-1] <- gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001]
gene_presence_absence_2004 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
gene_presence_absence_2004[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
gene_presence_absence_2004[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2004[-1,-1] <- gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004]
gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004]
gene_presence_absence[-1,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001]
Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004
# empty gene presence absence matrix
gene_presence_absence_2001 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)+1))
gene_presence_absence_2001[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`)
gene_presence_absence_2001[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2001[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2001)]
gene_presence_absence_2004 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)+1))
gene_presence_absence_2004[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2004,]$`Isolate Name`)
gene_presence_absence_2004[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2004[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2004)]
gene_presence_absence_2007 <- data.frame(matrix(0, nrow = length(cls_files)+1, ncol = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)+1))
gene_presence_absence_2007[1,-1] <- (Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2007,]$`Isolate Name`)
gene_presence_absence_2007[-1,1] <- gene_presence_absence[-1,1]
gene_presence_absence_2007[-1,-1] <- gene_presence_absence[-1,c(FALSE,Mass_year_dict[unlist(gene_presence_absence[1,-1])]==2007)]
View(gene_presence_absence_2004)
length(cls_files)+1
cols(gene_presence_absence_2001)
col(gene_presence_absence_2001)
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rowMeans(gene_presence_absence_2001[-1,-1])
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rowSums(gene_presence_absence_2001[-1,-1])
gene_presence_absence_2001[-1,-1]
gene_presence_absence_2001[2,2] + gene_presence_absence_2001[3,2]
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rowSums(as.numeric(gene_presence_absence_2001[-1,-1]))
gene_presence_absence_2001[-1,2]==1
as.numeric(gene_presence_absence_2001[-1,2]==1)
sum(as.numeric(gene_presence_absence_2001[-1,2]==1))
rowSums(as.numeric(gene_presence_absence_2001[-1,]==1))
as.numeric(gene_presence_absence_2001[-1,]==1)
as.numeric(gene_presence_absence_2001[-1,-1]==1)
sum(gene_presence_absence_2001[-1,-1])
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- lapply(gene_presence_absence_2001[-1,]==1,sum)
gene_cluster_freqs_1
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- unlist(lapply(gene_presence_absence_2001[-1,]==1,sum))[-1]
gene_cluster_freqs_1
lapply(gene_presence_absence_2001[-1,]==1,sum)
gene_presence_absence_2001[-1,]==1
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- unlist(lapply(as.numeric(gene_presence_absence_2001[-1,]==1),sum))[-1]
gene_cluster_freqs_1
tail(gene_cluster_freqs_1)
as.numeric(gene_presence_absence_2001[-1,-1])
as.numeric(unlist(gene_presence_absence_2001[-1,-1]))
as.numeric(as.matrix(gene_presence_absence_2001[-1,-1]))
test1 <- as.numeric(as.matrix(gene_presence_absence_2001[-1,-1]))
dim(test1)
test1 <- as.matrix(as.numeric(unlist(gene_presence_absence_2001[-1,-1])), rows = length(Mass_Samples_accCodes[Mass_Samples_accCodes$`Year of Isolation`==2001,]$`Isolate Name`))
test1
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[-1,i+1]==1))
}
gene_cluster_freqs_1
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
gene_cluster_freqs_1
gene_cluster_freqs_2 <- rep(0, length(cls_files))
gene_cluster_freqs_2 <- rep(0, length(cls_files))
calculate_rowSum <- function(data_row){
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,],1,calculate_rowSum)
gene_cluster_freqs_2
equal(gene_cluster_freqs_1,gene_cluster_freqs_2)
identical(gene_cluster_freqs_1,gene_cluster_freqs_2)
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
identical(gene_cluster_freqs_1,gene_cluster_freqs_2)
gene_cluster_freqs_2
gene_cluster_freqs_2 <- rep(0, length(cls_files))
calculate_rowSum <- function(data_row){
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2
gene_presence_absence_2001[-1,-1]
gene_cluster_freqs_2 <- rep(0, length(cls_files))
calculate_rowSum <- function(data_row){
print(data_row_)
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(data_row)
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(as.numeric(data_row==1))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
calculate_rowSum <- function(data_row){
print(sum(as.numeric(data_row==1)))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2
dim(apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum))
calculate_rowSum <- function(data_row){
#print(sum(as.numeric(data_row==1)))
sum(as.numeric(data_row==1))
}
gene_cluster_freqs_2 <- apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)
gene_cluster_freqs_2[1]
apply(gene_presence_absence_2001[-1,-1],1,calculate_rowSum)[1]
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
gene_cluster_freqs_2 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
# calculate cluster freqs per time point
gene_cluster_freqs_1 <- rep(0, length(cls_files))
gene_cluster_freqs_1
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))
}
gene_cluster_freqs_1
gene_cluster_freqs_2
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))
}
gene_cluster_freqs_2
gene_cluster_freqs_3 <- rep(0, length(cls_files))
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
gene_cluster_freqs_3
length(gene_presence_absence_2001[1,-1])
for(i in 1:length(cls_files)){
gene_cluster_freqs_1[i] <- sum(as.numeric(gene_presence_absence_2001[i+1,-1]==1))/length(gene_presence_absence_2001[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))/length(gene_presence_absence_2004[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_2[i] <- sum(as.numeric(gene_presence_absence_2004[i+1,-1]==1))/length(gene_presence_absence_2004[1,-1])
}
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))
}
```
length(gene_presence_absence_2007[1,-1])
for(i in 1:length(cls_files)){
gene_cluster_freqs_3[i] <- sum(as.numeric(gene_presence_absence_2007[i+1,-1]==1))/length(gene_presence_absence_2007[1,-1])
}
gene_cluster_freqs_2
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_2)
sort.list(gene_cluster_freqs_1)
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_1)
gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)]
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)])
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)])
plot(1:length(gene_cluster_freqs_1), gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
line(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "l", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]])
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "l", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9")
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
plot(1:1500, gene_cluster_freqs_1[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(1:1500, gene_cluster_freqs_2[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#E69F00",type = "b")
lines(1:1500, gene_cluster_freqs_3[sort.list(gene_cluster_freqs_1)[1:1500]], col = "#56B4E9", type = "b")
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
library(zoo)
rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 3)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 3))
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 20))
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 20), col = "#E69F00", lty = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00")
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", pch = 19)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 100), col = "#E69F00", pch = 19)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 100), col = "#E69F00", lwd = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
plot(1:1500, abs(gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean(abs(gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_2)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_2), 50), col = "#E69F00", lwd = 5)
plot(1:1500, (gene_cluster_freqs_1-gene_cluster_freqs_3)[sort.list(gene_cluster_freqs_1)[1:1500]],type = "b", lty = 1)
lines(rollmean((gene_cluster_freqs_1-gene_cluster_freqs_3), 50), col = "#E69F00", lwd = 5)
